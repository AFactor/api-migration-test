info:
  x-ibm-name: local-collect-api-v2-rest
  version: 3.0.1-rev19
  description: >-
    Local Collect is a delivery enhancement to Royal Mail Tracked & Special
    Delivery Guaranteed products that enables customers to benefit from ‘Click
    and Collect’ options by having their parcels delivered to participating Post
    Offices and Royal Mail enquiry offices. The Local Collect API allows
    customers to retrieve an up-to-date list of Post Offices and Royal Mail
    Enquiry Offices, where the item can be held awaiting collection.





    There are no costs to customers for using the Local Collect API services,
    however development costs must be covered by the customer. Royal Mail will
    not accept any responsibility for these development, implementation and
    testing costs.
  title: Local Collect API V2 (REST)
paths:
  /geo/spatial:
    get:
      responses:
        '200':
          examples:
            application/json:
              locations:
                location:
                  - city: city
                    organisationName: Post Office Corp
                    geoLocation:
                      latitude: '10'
                      longitude: '10'
                    locationType: Post Office
                    county: Address5
                    locationName: Branch Name1
                    facilities:
                      customerParkingIndicator: 'true'
                      disabilityIndicator: 'true'
                    addressLine2: Address2
                    postcode: M11AD
                    addressLine1: Address1
                    openingHours:
                      - dayOfWeek: Mondayish
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Tuesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Wednesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Thursday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Friday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                    distance: '1'
                  - county: Address5
                    organisationName: Post Office Ltd
                    geoLocation:
                      latitude: '11'
                      longitude: '10'
                    locationType: Post Office
                    locationName: Branch Name2
                    addressLine2: Address2
                    postcode: M11AD
                    addressLine1: Address1
                    openingHours:
                      - dayOfWeek: Monday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Tuesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Wednesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Thursday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Friday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                    distance: '2'
                  - county: Address5
                    organisationName: Post Office Ltd
                    geoLocation:
                      latitude: '12'
                      longitude: '10'
                    locationType: Post Office
                    locationName: Branch Name3
                    facilities:
                      customerParkingIndicator: 'true'
                      disabilityIndicator: 'true'
                    addressLine2: Address2
                    postcode: M11AD
                    addressLine1: Address1
                    openingHours:
                      - dayOfWeek: Monday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Tuesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Wednesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Thursday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Friday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                    distance: '3'
          description: ''
          schema: {}
      parameters:
        - description: Search Radius in miles. Max 10.
          default: '{radius}'
          required: false
          in: query
          type: string
          name: radius
        - description: Longitude. Can use float/decimal
          default: '{longitude}'
          required: false
          in: query
          type: string
          name: longitude
        - description: Latitude. Can use float/decimal
          default: '{latitude}'
          required: false
          in: query
          type: string
          name: latitude
        - description: "'Post Office' or 'Enquiry Office'"
          default: '{type}'
          required: false
          in: query
          type: string
          name: type
      tags: []
      summary: Search By Geo Lookup
      security:
        - CLIENT_ID: []
      description: This operation provides the location based on the latitude and longitude which are part of the query parameters
  '/{postcode}':
    get:
      responses:
        '200':
          examples:
            application/json:
              locations:
                location:
                  - city: city
                    organisationName: Post Office Corp
                    geoLocation:
                      latitude: '10'
                      longitude: '10'
                    locationType: Post Office
                    county: Address5
                    locationName: Branch Name1
                    facilities:
                      customerParkingIndicator: 'true'
                      disabilityIndicator: 'true'
                    addressLine2: Address2
                    postcode: M11AD
                    addressLine1: Address1
                    openingHours:
                      - dayOfWeek: Mondayish
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Tuesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Wednesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Thursday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Friday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                    distance: '1'
                  - county: Address5
                    organisationName: Post Office Ltd
                    geoLocation:
                      latitude: '11'
                      longitude: '10'
                    locationType: Post Office
                    locationName: Branch Name2
                    addressLine2: Address2
                    postcode: M11AD
                    addressLine1: Address1
                    openingHours:
                      - dayOfWeek: Monday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Tuesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Wednesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Thursday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Friday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                    distance: '2'
                  - county: Address5
                    organisationName: Post Office Ltd
                    geoLocation:
                      latitude: '12'
                      longitude: '10'
                    locationType: Post Office
                    locationName: Branch Name3
                    facilities:
                      customerParkingIndicator: 'true'
                      disabilityIndicator: 'true'
                    addressLine2: Address2
                    postcode: M11AD
                    addressLine1: Address1
                    openingHours:
                      - dayOfWeek: Monday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Tuesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Wednesday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Thursday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                      - dayOfWeek: Friday
                        openingTime: '10:00:00'
                        lunchHours:
                          lunchClosingTime: '13:00:00'
                          lunchOpeningTime: '13:30:00'
                        closingTime: '18:00:00'
                    distance: '3'
          description: Successful response
          schema: {}
        '400':
          examples:
            application/json:
              faultcode: Client
              faultstring: Invalid Request
              faultactor: W000001-747-MULTIPLE
              detail:
                exceptionTransactionId: f3eed6d6-bc69-4295-a3a1-b3869165a464
                exceptionText: Failed Schema Validation
                exceptionCode: E0004
          description: Bad Request. Probably malformed request
          schema:
            $ref: '#/definitions/errorResponse'
        '401':
          description: Authorisation failure
          schema:
            $ref: '#/definitions/errorResponse'
        '404':
          description: Resource not found
          schema:
            $ref: '#/definitions/errorResponse'
        '429':
          description: Too many requests
          schema:
            $ref: '#/definitions/errorResponse'
        '500':
          description: Internal Server Error
          schema:
            $ref: '#/definitions/errorResponse'
        '503':
          examples:
            application/json:
              status: Invalid
              code: '2'
              description: All wrong
              cause: some cause
              context: context
              resolution: some resoltion
          description: Service Unavailable
          schema: {}
        '504':
          description: Gateway Timeout
          schema:
            $ref: '#/definitions/errorResponse'
      parameters:
        - description: ''
          required: true
          type: string
          name: postcode
          in: path
        - description: Radius in miles. Max 10.
          default: '{radius}'
          required: false
          in: query
          type: string
          name: radius
        - description: "'Post Office' or 'Enquiry Office'"
          default: '{type}'
          required: false
          in: query
          type: string
          name: type
      tags: []
      summary: ''
      security:
        - CLIENT_ID: []
      description: Gets Local Collect `POL or EO Branch` objects.Mandatory path param postCode determinesthe epicentre of the search radius
schemes:
  - https
tags: []
basePath: /localcollect/v2/locations/ProdTest
x-ibm-configuration:
  enforced: true
  assembly:
    catch:
      - execute:
          - map:
              inputs:
                input:
                  variable: response1.body
                  content: application/xml
                  schema:
                    xml:
                      namespace: ''
                    example: "<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:int=\"http://www.royalmailgroup.com/integration/core/V3\">\r\n   <soap:Body>\r\n      <soap:Fault>\r\n         <faultcode>Client</faultcode>\r\n         <faultstring>Invalid Request</faultstring>\r\n         <faultactor>XB62</faultactor>\r\n         <detail>\r\n            <int:exceptionDetails>\r\n               <exceptionApplicationId>12345</exceptionApplicationId>\r\n               <exceptionTransactionId>12345</exceptionTransactionId>\r\n               <exceptionCode>E0004</exceptionCode>\r\n               <exceptionText>Failed Schema Validation</exceptionText>\r\n            </int:exceptionDetails>\r\n         </detail>\r\n      </soap:Fault>\r\n   </soap:Body>\r\n</soap:Envelope>"
                    type: object
                    description: ''
                    properties:
                      Envelope:
                        xml:
                          prefix: soap
                          namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                        type: object
                        properties:
                          Body:
                            type: object
                            properties:
                              Fault:
                                type: object
                                properties:
                                  faultcode:
                                    xml:
                                      namespace: ''
                                    type: string
                                  faultstring:
                                    xml:
                                      namespace: ''
                                    type: string
                                  faultactor:
                                    xml:
                                      namespace: ''
                                    type: string
                                  detail:
                                    xml:
                                      namespace: ''
                                    type: object
                                    properties:
                                      exceptionDetails:
                                        xml:
                                          prefix: int
                                          namespace: 'http://www.royalmailgroup.com/integration/core/V3'
                                        type: object
                                        properties:
                                          exceptionTransactionId:
                                            xml:
                                              namespace: ''
                                            type: string
                                          exceptionApplicationId:
                                            xml:
                                              namespace: ''
                                            type: string
                                          exceptionText:
                                            xml:
                                              namespace: ''
                                            type: string
                                          exceptionCode:
                                            xml:
                                              namespace: ''
                                            type: string
              version: 1.0.0
              actions:
                - set: fault.code
                  from: input.Envelope.Body.Fault.detail.exceptionDetails.exceptionCode
              outputs:
                fault:
                  variable: message.body
                  content: application/json
                  schema:
                    $ref: '#/definitions/errorResponse'
              title: map
          - gatewayscript:
              source: >-
                var err = apim.getvariable('message.body');

                var errorCode =  err["code"];





                switch(errorCode) {



                    case "E0001":



                        apim.setvariable('message.status.code', '503');



                        err.status = 503;



                        err.description = "Service Unavailable";



                        err.cause = "Service Unavailable";



                        err.resolution = "Please report the problem to the

                Customer Solutions team"



                        break;



                    case "E0002":



                        apim.setvariable('message.status.code', '503');



                        err.status = 503;



                        err.description = "Service Temporarily Unavailable.

                Please try again later.";



                        err.cause = "Service Temporarily Unavailable. Please try

                again later.";



                        err.resolution = "Please retry the request at a later

                stage."



                        break;



                    case "E0004":



                        apim.setvariable('message.status.code', '400');



                        err.status = 400;



                        err.description = "Failed Schema Validation";



                        err.cause = "Failed Schema Validation";



                        err.resolution = "Please confirm that the request is
                well

                formed and then try again.";



                        break;



                    case "E0009":



                        apim.setvariable('message.status.code', '500');



                        err.status = 500;



                        err.description = "Business Fulfilment System Returned
                an

                Error Response";



                        err.cause = "Business Fulfilment System Returned an
                Error

                Response";



                        err.resolution = "Please contact Customer solutions

                team";



                        break;



                    case "E0005":



                        apim.setvariable('message.status.code', '504');



                        err.status = 504;



                        err.description = "No Response Received from Business

                Fulfilment System Web Service (Service is Unavailable or
                Timeout)";



                        err.cause = "No Response Received from Business

                Fulfilment System Web Service (Service is Unavailable or
                Timeout)";



                        err.resolution = "Please retry the request at a later

                stage.";



                        break;



                     case "E0006":



                        apim.setvariable('message.status.code', '401');



                        err.status = 401;



                        err.description = "Authorization failure";



                        err.cause = "Authorization failure";



                        err.resolution = "Please contact Customer solutions

                team";



                        break;



                     case "E0010":



                        apim.setvariable('message.status.code', '429');



                        err.status = 429;



                        err.description = "Configured Throttling Rate for
                Service

                Exceeded. Please try again later.";



                        err.cause = "Configured Throttling Rate for Service

                Exceeded. Please try again later.";



                        err.resolution = "Please contact Customer solutions team

                to discuss throttling rate.";



                        break;



                    default:



                        apim.setvariable('message.status.code', '400');



                        err.status = 400;



                }





                apim.setvariable('message.body', err);
              version: 1.0.0
              title: gatewayscript-throw
        errors:
          - SOAPError
          - OperationError
          - ConnectionError
    execute:
      - activity-log:
          content: $(Activity Log Level)
          error-content: $(Error Log Level)
      - operation-switch:
          case:
            - operations:
                - path: '/{postcode}'
                  verb: get
              execute:
                - map:
                    inputs:
                      in1:
                        variable: request.parameters
                        schema:
                          type: object
                          properties:
                            type:
                              type: string
                              name: type
                            radius:
                              type: string
                              name: radius
                            postcode:
                              type: string
                              name: postcode
                    options:
                      includeEmptyXMLElements: false
                      inlineNamespaces: false
                    actions:
                      - set: out1.Envelope.Body.getLocationsRequest.postCode
                        from: '#/in1.postcode'
                      - set: out1.Envelope.Body.getLocationsRequest.locationType
                        from: '#/in1.type'
                      - default: 2
                        set: out1.Envelope.Body.getLocationsRequest.radius
                        from: '#/in1.radius'
                      - default: $(client.app.id)
                        set: out1.Envelope.header1.integrationHeader.identification.applicationId
                      - default: $(request.headers.x-global-transaction-id)
                        set: out1.Envelope.header1.integrationHeader.identification.transactionId
                      - default: 'text/xml; charset="UTF-8"'
                        set: out2.Content-Type
                      - default: '"http://royalmail.com/LocalCollectInterfacev3_0/getLocalCollectLocations"'
                        set: out2.SOAPAction
                    outputs:
                      out1:
                        variable: message.body
                        content: application/xml
                        schema:
                          type: object
                          properties:
                            Envelope:
                              xml:
                                prefix: soap11-env
                                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                              type: object
                              properties:
                                Body:
                                  type: object
                                  properties:
                                    getLocationsRequest:
                                      xml:
                                        prefix: p0
                                        namespace: 'http://www.royalmailgroup.com/API/LocalCollect/schema/V2.0'
                                      type: object
                                      properties:
                                        locationType:
                                          xml:
                                            namespace: ''
                                          type: string
                                          name: locationType
                                        radius:
                                          xml:
                                            namespace: ''
                                          default: 2
                                          type: number
                                          format: float
                                          name: radius
                                        postCode:
                                          xml:
                                            namespace: ''
                                          type: string
                                          name: postCode
                                      name: getLocationsRequest
                                  name: Body
                                header1:
                                  xml:
                                    name: Header
                                  type: object
                                  properties:
                                    integrationHeader:
                                      xml:
                                        prefix: p2
                                        namespace: 'http://www.royalmailgroup.com/integration/core/V3'
                                      type: object
                                      properties:
                                        identification:
                                          xml:
                                            namespace: ''
                                          type: object
                                          properties:
                                            applicationId:
                                              default: $(client.app.id)
                                              type: string
                                              name: applicationId
                                            transactionId:
                                              default: $(request.headers.x-global-transaction-id)
                                              type: string
                                              name: transactionId
                                          name: identification
                                      name: integrationHeader
                                  name: header1
                              name: Envelope
                      out2:
                        variable: message.headers
                        schema:
                          type: object
                          properties:
                            SOAPAction:
                              default: '"http://royalmail.com/LocalCollectInterfacev3_0/getLocalCollectLocations"'
                              type: string
                              name: SOAPAction
                            Content-Type:
                              default: 'text/xml; charset="UTF-8"'
                              type: string
                              name: Content-Type
            - operations:
                - path: /geo/spatial
                  verb: get
              execute:
                - map:
                    inputs:
                      in1:
                        variable: request.parameters
                        schema:
                          type: object
                          properties:
                            latitude:
                              type: string
                              name: latitude
                            type:
                              type: string
                              name: type
                            radius:
                              type: number
                              name: radius
                            longitude:
                              type: string
                              name: longitude
                    options:
                      includeEmptyXMLElements: false
                      inlineNamespaces: false
                    actions:
                      - set: out1.Envelope.Body.getLocationsRequest.locationType
                        from: '#/in1.type'
                      - default: $(client.app.id)
                        set: out1.Envelope.header1.integrationHeader.identification.applicationId
                      - default: $(request.headers.x-global-transaction-id)
                        set: out1.Envelope.header1.integrationHeader.identification.transactionId
                      - set: out1.Envelope.Body.getLocationsRequest.geoLocation.latitude
                        from: '#/in1.latitude'
                      - set: out1.Envelope.Body.getLocationsRequest.geoLocation.longitude
                        from: '#/in1.longitude'
                      - default: 'text/xml; charset="UTF-8"'
                        set: out2.Content-Type
                      - default: '"http://royalmail.com/LocalCollectInterfacev3_0/getLocalCollectLocations"'
                        set: out2.SOAPAction
                      - set: out1.Envelope.Body.getLocationsRequest.radius
                        from: in1.radius
                    outputs:
                      out1:
                        variable: message.body
                        content: application/xml
                        schema:
                          type: object
                          properties:
                            Envelope:
                              xml:
                                prefix: soap11-env
                                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                              type: object
                              properties:
                                Body:
                                  type: object
                                  properties:
                                    getLocationsRequest:
                                      xml:
                                        prefix: p0
                                        namespace: 'http://www.royalmailgroup.com/API/LocalCollect/schema/V2.0'
                                      type: object
                                      properties:
                                        geoLocation:
                                          xml:
                                            namespace: ''
                                          type: object
                                          properties:
                                            latitude:
                                              type: number
                                              format: float
                                              name: latitude
                                            longitude:
                                              type: number
                                              format: float
                                              name: longitude
                                          name: geoLocation
                                        radius:
                                          xml:
                                            namespace: ''
                                          type: number
                                          format: float
                                          name: radius
                                        locationType:
                                          xml:
                                            namespace: ''
                                          type: string
                                          name: locationType
                                      name: getLocationsRequest
                                  name: Body
                                header1:
                                  xml:
                                    name: Header
                                  type: object
                                  properties:
                                    integrationHeader:
                                      xml:
                                        prefix: p2
                                        namespace: 'http://www.royalmailgroup.com/integration/core/V3'
                                      type: object
                                      properties:
                                        identification:
                                          xml:
                                            namespace: ''
                                          type: object
                                          properties:
                                            applicationId:
                                              default: $(client.app.id)
                                              type: string
                                              name: applicationId
                                            transactionId:
                                              default: $(request.headers.x-global-transaction-id)
                                              type: string
                                              name: transactionId
                                          name: identification
                                      name: integrationHeader
                                  name: header1
                              name: Envelope
                      out2:
                        variable: message.headers
                        schema:
                          type: object
                          properties:
                            SOAPAction:
                              default: '"http://royalmail.com/LocalCollectInterfacev3_0/getLocalCollectLocations"'
                              type: string
                              name: SOAPAction
                            Content-Type:
                              default: 'text/xml; charset="UTF-8"'
                              type: string
                              name: Content-Type
          title: operation-switch
      - invoke:
          timeout: 60
          tls-profile: $(certificate name)
          target-url: $(Local Collect Endpoint)
          verb: POST
          stop-on-error:
            - ConnectionError
            - OperationError
            - SOAPError
          output: response1
      - map:
          inputs:
            in1:
              variable: response1.body
              content: application/xml
              schema:
                type: object
                properties:
                  Envelope:
                    xml:
                      prefix: soap11-env
                      namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                    type: object
                    properties:
                      Body:
                        type: object
                        properties:
                          getLocationsResponse:
                            xml:
                              prefix: p0
                              namespace: 'http://www.royalmailgroup.com/API/LocalCollect/schema/V2.0'
                            type: object
                            properties:
                              locations:
                                xml:
                                  namespace: ''
                                type: object
                                properties:
                                  location:
                                    items:
                                      type: object
                                      properties:
                                        city:
                                          type: string
                                          name: city
                                        organisationName:
                                          type: string
                                          name: organisationName
                                        geoLocation:
                                          type: object
                                          properties:
                                            latitude:
                                              type: number
                                              format: float
                                              name: latitude
                                            longitude:
                                              type: number
                                              format: float
                                              name: longitude
                                          name: geoLocation
                                        locationType:
                                          type: string
                                          name: locationType
                                        distance:
                                          type: number
                                          format: float
                                          name: distance
                                        county:
                                          type: string
                                          name: county
                                        locationName:
                                          type: string
                                          name: locationName
                                        facilities:
                                          type: object
                                          properties:
                                            customerParkingIndicator:
                                              type: string
                                              name: customerParkingIndicator
                                            disabilityIndicator:
                                              type: string
                                              name: disabilityIndicator
                                          name: facilities
                                        addressLine2:
                                          type: string
                                          name: addressLine2
                                        addressLine3:
                                          type: string
                                          name: addressLine3
                                        addressLine1:
                                          type: string
                                          name: addressLine1
                                        openingHours:
                                          items:
                                            type: object
                                            properties:
                                              dayOfWeek:
                                                type: string
                                                name: dayOfWeek
                                              openingTime:
                                                type: string
                                                name: openingTime
                                              lunchHours:
                                                type: object
                                                properties:
                                                  lunchClosingTime:
                                                    type: string
                                                    name: lunchClosingTime
                                                  lunchOpeningTime:
                                                    type: string
                                                    name: lunchOpeningTime
                                                name: lunchHours
                                              closingTime:
                                                type: string
                                                name: closingTime
                                          type: array
                                          name: openingHours
                                        postcode:
                                          type: string
                                          name: postcode
                                    type: array
                                    name: location
                                name: locations
                              integrationFooter:
                                xml:
                                  namespace: ''
                                type: object
                                properties:
                                  errors:
                                    type: object
                                    properties:
                                      error:
                                        items:
                                          type: object
                                          properties:
                                            errorCode:
                                              type: string
                                              name: errorCode
                                            errorDescription:
                                              type: string
                                              name: errorDescription
                                            errorResolution:
                                              type: string
                                              name: errorResolution
                                            errorCause:
                                              type: string
                                              name: errorCause
                                            errorContext:
                                              type: string
                                              name: errorContext
                                        type: array
                                        name: error
                                    name: errors
                                  warnings:
                                    type: object
                                    properties:
                                      warning:
                                        items:
                                          type: object
                                          properties:
                                            warningCode:
                                              type: string
                                              name: warningCode
                                            warningDescription:
                                              type: string
                                              name: warningDescription
                                            warningResolution:
                                              type: string
                                              name: warningResolution
                                            warningContext:
                                              type: string
                                              name: warningContext
                                            warningCause:
                                              type: string
                                              name: warningCause
                                        type: array
                                        name: warning
                                    name: warnings
                                name: integrationFooter
                            name: getLocationsResponse
                          Fault:
                            type: object
                            properties:
                              faultcode:
                                enum:
                                  - VersionMismatch
                                  - MustUnderstand
                                  - Client
                                  - Server
                                type: string
                                name: faultcode
                              faultstring:
                                type: string
                                name: faultstring
                              faultactor:
                                type: string
                                name: faultactor
                              detail:
                                type: object
                                properties:
                                  exceptionDetails:
                                    xml:
                                      prefix: p2
                                      namespace: 'http://www.royalmailgroup.com/integration/core/V3'
                                    type: object
                                    properties:
                                      exceptionTransactionId:
                                        xml:
                                          namespace: ''
                                        type: string
                                        name: exceptionTransactionId
                                      exceptionApplicationId:
                                        xml:
                                          namespace: ''
                                        type: string
                                        name: exceptionApplicationId
                                      exceptionText:
                                        xml:
                                          namespace: ''
                                        type: string
                                        name: exceptionText
                                      exceptionCode:
                                        xml:
                                          namespace: ''
                                        type: string
                                        name: exceptionCode
                                    name: exceptionDetails
                                name: detail
                            name: Fault
                        name: Body
                      header1:
                        xml:
                          name: Header
                        type: object
                        properties:
                          integrationHeader:
                            xml:
                              prefix: p1
                              namespace: 'http://www.royalmailgroup.com/integration/core/V3'
                            type: object
                            properties:
                              debugAudit:
                                xml:
                                  namespace: ''
                                type: object
                                properties:
                                  messageAuditFlag:
                                    type: string
                                    name: messageAuditFlag
                                  testFlag:
                                    type: string
                                    name: testFlag
                                  debugFlag:
                                    type: string
                                    name: debugFlag
                                  performanceFlag:
                                    type: string
                                    name: performanceFlag
                                name: debugAudit
                              version:
                                xml:
                                  namespace: ''
                                type: number
                                format: float
                                name: version
                              identification:
                                xml:
                                  namespace: ''
                                type: object
                                properties:
                                  applicationId:
                                    type: string
                                    name: applicationId
                                  transactionId:
                                    type: string
                                    name: transactionId
                                  intermediaryId:
                                    type: string
                                    name: intermediaryId
                                  endUserId:
                                    type: string
                                    name: endUserId
                                  clientId:
                                    type: string
                                    name: clientId
                                name: identification
                              dateTime:
                                xml:
                                  namespace: ''
                                type: string
                                name: dateTime
                            name: integrationHeader
                        name: header1
                    name: Envelope
          options:
            includeEmptyXMLElements: false
            inlineNamespaces: false
          actions:
            - set: fault.code
              from:
                - in1.Envelope.Body.getLocationsResponse.integrationFooter.errors.error.errorCode
                - in1.Envelope.Body.Fault.detail.exceptionDetails.exceptionCode
            - set: fault.description
              from:
                - in1.Envelope.Body.getLocationsResponse.integrationFooter.errors.error.errorDescription
                - in1.Envelope.Body.Fault.detail.exceptionDetails.exceptionText
            - set: fault.cause
              from: in1.Envelope.Body.getLocationsResponse.integrationFooter.errors.error.errorCause
            - set: fault.resolution
              from: in1.Envelope.Body.getLocationsResponse.integrationFooter.errors.error.errorResolution
            - set: fault.context
              from: in1.Envelope.Body.getLocationsResponse.integrationFooter.errors.error.errorContext
            - set: warnings
              from: in1.Envelope.Body.getLocationsResponse.integrationFooter.warnings
            - create: out.locations
              from: in1.Envelope.Body.getLocationsResponse.locations.location
              foreach: in1.Envelope.Body.getLocationsResponse.locations.location
              actions:
                - set: organisationName
                  from: organisationName
                - set: locationName
                  from: locationName
                - set: addressLine1
                  from: addressLine1
                - set: addressLine2
                  from: addressLine2
                - set: addressLine3
                  from: addressLine3
                - set: city
                  from: city
                - set: postcode
                  from: postcode
                - create: openingHours
                  from: openingHours
                  foreach: openingHours
                  actions:
                    - set: dayOfWeek
                      from: dayOfWeek
                    - set: openingTime
                      from: openingTime
                    - set: closingTime
                      from: closingTime
                    - set: lunchHours.lunchClosing
                      from: lunchHours.lunchClosingTime
                    - set: lunchHours.lunchOpening
                      from: lunchHours.lunchOpeningTime
                - set: geoLocation.latitude
                  from: geoLocation.latitude
                - set: geoLocation.longitude
                  from: geoLocation.longitude
                - set: distance
                  from: distance
                - set: locationType
                  from: locationType
                - set: facilities.customerParkingIndicator
                  from: facilities.customerParkingIndicator
                - set: facilities.disabilityIndicator
                  from: facilities.disabilityIndicator
          outputs:
            fault:
              variable: message.body
              schema:
                $ref: '#/definitions/errorResponse'
            warnings:
              variable: message.body
              schema:
                example: |-
                  {
                    "warnings": [
                      {
                        "code": "",
                        "description": "",
                        "cause": "",
                        "resolution": "",
                        "context": ""
                      }
                    ]
                  }
                type: object
                description: ''
                properties:
                  warnings:
                    items:
                      type: object
                      properties:
                        resolution:
                          type: string
                          name: resolution
                        code:
                          type: string
                          name: code
                        cause:
                          type: string
                          name: cause
                        description:
                          type: string
                          name: description
                        context:
                          type: string
                          name: context
                    type: array
                    name: warnings
            out:
              variable: message.body
              content: application/json
              schema:
                example: |-
                  {
                    "locations": [
                      {
                        "organisationName": "RoyalMailGroup",
                        "locationName": "Sheffield South Delivery Office",
                        "addressLine1": "Royal Mail",
                        "addressLine2": "Sheffield South Delivery Office",
                        "addressLine3": "61 Woodseats Road",
                        "city": "Sheffield",
                        "postcode": "S80PG",
                        "openingHours": [
                          {
                            "dayOfWeek": "Monday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Tuesday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Wednesday",
                            "openingTime": "07:00:00",
                            "closingTime": "20:00:00"
                          },
                          {
                            "dayOfWeek": "Thursday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Friday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Saturday",
                            "openingTime": "07:00:00",
                            "closingTime": "14:00:00"
                          }
                        ],
                        "geoLocation": {
                          "latitude": "53.3508",
                          "longitude": "-1.4843"
                        },
                        "facilities": {
                          "customerParkingIndicator": "false",
                          "disabilityIndicator": "true"
                        },
                        "locationType": "Enquiry Office",
                        "distance": "2"
                      },
                      {
                        "organisationName": "RoyalMailGroup",
                        "locationName": "Dronfield Delivery Office",
                        "addressLine1": "Royal Mail",
                        "addressLine2": "Dronfield Delivery Office",
                        "addressLine3": "Callywhite Lane",
                        "city": "Dronfield",
                        "postcode": "S182AA",
                        "openingHours": [
                          {
                            "dayOfWeek": "Monday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Tuesday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Wednesday",
                            "openingTime": "07:00:00",
                            "closingTime": "20:00:00"
                          },
                          {
                            "dayOfWeek": "Thursday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Friday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Saturday",
                            "openingTime": "07:00:00",
                            "closingTime": "14:00:00"
                          }
                        ],
                        "geoLocation": {
                          "latitude": "53.3",
                          "longitude": "-1.4527"
                        },
                        "facilities": {
                          "customerParkingIndicator": "false",
                          "disabilityIndicator": "true"
                        },
                        "locationType": "Enquiry Office",
                        "distance": "3"
                      },
                      {
                        "organisationName": "RoyalMailGroup",
                        "locationName": "Sheffield West Delivery Office",
                        "addressLine1": "Royal Mail",
                        "addressLine2": "Sheffield West Delivery Office",
                        "addressLine3": "175 Tapton Hill Road",
                        "city": "Sheffield",
                        "postcode": "S101BQ",
                        "openingHours": [
                          {
                            "dayOfWeek": "Sunday",
                            "openingTime": "10:00:00",
                            "closingTime": "14:00:00"
                          },
                          {
                            "dayOfWeek": "Monday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Tuesday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Wednesday",
                            "openingTime": "07:00:00",
                            "closingTime": "20:00:00"
                          },
                          {
                            "dayOfWeek": "Thursday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Friday",
                            "openingTime": "07:00:00",
                            "closingTime": "12:00:00"
                          },
                          {
                            "dayOfWeek": "Saturday",
                            "openingTime": "07:00:00",
                            "closingTime": "14:00:00"
                          }
                        ],
                        "geoLocation": {
                          "latitude": "53.3792",
                          "longitude": "-1.5162"
                        },
                        "facilities": {
                          "customerParkingIndicator": "false",
                          "disabilityIndicator": "true"
                        },
                        "locationType": "Enquiry Office",
                        "distance": "4"
                      }
                    ]
                  }
                type: object
                description: ''
                properties:
                  locations:
                    items:
                      type: object
                      properties:
                        city:
                          type: string
                          name: city
                        organisationName:
                          type: string
                          name: organisationName
                        geoLocation:
                          type: object
                          properties:
                            latitude:
                              type: string
                              name: latitude
                            longitude:
                              type: string
                              name: longitude
                          name: geoLocation
                        locationType:
                          type: string
                          name: locationType
                        distance:
                          type: string
                          name: distance
                        county:
                          type: string
                          name: county
                        locationName:
                          type: string
                          name: locationName
                        facilities:
                          type: object
                          properties:
                            customerParkingIndicator:
                              type: string
                              name: customerParkingIndicator
                            disabilityIndicator:
                              type: string
                              name: disabilityIndicator
                          name: facilities
                        addressLine2:
                          type: string
                          name: addressLine2
                        addressLine3:
                          type: string
                          name: addressLine3
                        addressLine1:
                          type: string
                          name: addressLine1
                        openingHours:
                          items:
                            properties:
                              dayOfWeek:
                                type: string
                                name: dayOfWeek
                              openingTime:
                                type: string
                                name: openingTime
                              lunchHours:
                                type: object
                                properties:
                                  lunchOpening:
                                    type: string
                                    name: lunchOpening
                                  type: object
                                  lunchClosing:
                                    type: string
                                    name: lunchClosing
                                name: lunchHours
                              closingTime:
                                type: string
                                name: closingTime
                          type: array
                          name: openingHours
                        postcode:
                          type: string
                          name: postcode
                    type: array
                    name: locations
      - gatewayscript:
          source: "var json = apim.getvariable('message.body');\nif(json.code =='E1001'){\n   apim.setvariable('message.status.code', '404');\n   json.status = \"404\"; \n   delete json.locations;\n   \n   }\nelse if(json.code=='E1002' || json.code=='E1005' ){\n   apim.setvariable('message.status.code', '400');\n   json.status = \"400\"; \n   delete json.locations;\n   \n   }\nelse\n{\n    delete json.code;\n    delete json.description;\n    delete json.cause;\n    delete json.resolution;\n    delete json.context;\n   \n    for (var i = json.locations.length-1; i >= 0; i--) { \n    if (json.locations[i].locationName == undefined) { \n        json.locations.splice(i, 1);\n    } else if (json.locations[i].locationName.length == 0) {\n        json.locations.splice(i, 1);\n    }\n    }\n}\napim.setvariable('message.body', json);\n"
          version: 1.0.0
          title: gatewayscript
  externalDocs: []
  targets:
    LocalCollectServicev2_0:
      info:
        x-ibm-name: localcollectservicev20-1
        version: 1.0.0
        description: ''
        title: LocalCollectServicev2_0
      paths:
        /getLocations:
          post:
            x-ibm-soap:
              soap-action: 'http://royalmail.com/LocalCollectInterfacev3_0/getLocalCollectLocations'
              soap-operation: '{http://www.royalmailgroup.com/API/LocalCollect/V2.0}getLocations'
            responses:
              '500':
                description: ''
                schema:
                  $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/getLocationsFault'
              default:
                description: ''
                schema:
                  $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/getLocationsOutput'
            parameters:
              - schema:
                  $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/getLocationsInput'
                required: true
                name: body
                in: body
            description: ''
            summary: Operation getLocations
            operationId: getLocations
      schemes:
        - https
      produces:
        - application/xml
      basePath: /LocalCollectServicev2_0
      securityDefinitions:
        clientID:
          description: ''
          type: apiKey
          name: X-IBM-Client-Id
          in: header
      definitions:
        identificationStructure:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            applicationId:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/applicationId'
            transactionId:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/transactionId'
            intermediaryId:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/applicationId'
            endUserId:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/identifier'
            clientId:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/identifier'
          description: >-
            endUserId: User ID associated with the end user of the internal or
            external organisation;

            clientId: The ID of the Service Requester organisation or
            sub-organisation calling the service.;

            applicationId: The ID of the Service Requester system calling the
            service, unique when combined with the transactionId.;

            intermediaryId: Id associated with the Intermediary application (if
            applicable).;

            transactionId: Unique session id sent by the Service Requestor (for
            the request) or returned by the Service Provider (for the response)
        locations:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            location:
              items:
                $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/address'
              type: array
              maxItems: 20
        errorCode:
          xml:
            prefix: ''
            namespace: ''
          pattern: '[E]{1}[0-9]{4}'
          description: Code associated with the error condition in the form ENNNN
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/identifier'
        facilities:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            customerParkingIndicator:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/boolean'
            disabilityIndicator:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/boolean'
        wsSecurityHeader:
          xml:
            prefix: wsse
            namespace: 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
          type: object
          properties:
            UsernameToken:
              type: object
              properties:
                Username:
                  type: string
                Password:
                  type: string
        radius:
          xml:
            prefix: ''
            namespace: ''
          minimum: 0
          exclusiveMinimum: true
          maximum: 20
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/integer'
        postcode:
          xml:
            prefix: ''
            namespace: ''
          pattern: "[a-zA-Z][0-9a-zA-Z]+\\s?[0-9a-zA-Z]*"
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/string'
          minLength: 5
          maxLength: 8
        errorDetail:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            errorCode:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/errorCode'
            errorDescription:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            errorResolution:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            errorCause:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            errorContext:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
          description: >-
            errorCode: Code associated with the error condition;

            errorDescription: Description of the error condition;

            errorCause: Cause of the business error (if known);

            errorResolution: Description of the resolution and action required to
            correct the error;

            errorContext: Context of the business error, e.g. client or server
        longName:
          xml:
            prefix: ''
            namespace: ''
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/string'
          description: 'A long name is a sub-type of string and is word or a combination of words by which an organization, place, or thing, a body or class, or any object of thought is designated, called, or known.'
          maxLength: 128
        openingTime:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            dayOfWeek:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/dayOfWeek'
            openingTime:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/time'
            lunchHours:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/lunchTime'
            closingTime:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/time'
        applicationId:
          xml:
            prefix: ''
            namespace: ''
          description: 'For a request, this is the ID of the Service Requester calling the service, unique when combined with the TransactionId. For the response, this is the ID of the Service Provider, unique when combined with the TransactionId.'
          pattern: "[a-zA-Z0-9/\\-]*"
          maxLength: 50
          minLength: 1
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/identifier'
        debugAuditStructure:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            messageAuditFlag:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/boolean'
            testFlag:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/boolean'
            debugFlag:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/boolean'
            performanceFlag:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/boolean'
          description: >-
            testFlag: Flag which can be used to test that the exposed service is
            available. It is not expected that this flag will be used under
            normal BAU service operation;

            debugFlag: Flag which can be used to allow any messages to be
            dynamically debugged. It is not expected that this flag will be used
            under normal BAU service operation;

            performanceFlag: Flag which can be used to track the performance of
            the service between systems (entry time, exit time, latency etc);

            messageAuditFlag: Flag used to audit message exchanges between
            systems
        getLocationsInput:
          type: object
          properties:
            Envelope:
              xml:
                prefix: soap-env
                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
              type: object
              properties:
                Body:
                  type: object
                  properties:
                    getLocationsRequest:
                      $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/getLocationsRequest'
                Header:
                  $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/getLocationsHeader'
          example: >-
            <soap-env:Envelope
            xmlns:soap-env="http://schemas.xmlsoap.org/soap/envelope/">



             <soap-env:Header>



              <wsse:wsSecurityHeader

            xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">



               <UsernameToken>



                <Username>string</Username>



                <Password>string</Password>



               </UsernameToken>



              </wsse:wsSecurityHeader>



              <int:integrationHeader

            xmlns:int="http://www.royalmailgroup.com/integration/core/V3">



               <dateTime>2016-04-18T14:07:37</dateTime>



               <version>string</version>



               <identification>



                <endUserId>string</endUserId>



                <clientId>string</clientId>



                <applicationId>string</applicationId>



                <intermediaryId>string</intermediaryId>



                <transactionId>string</transactionId>



               </identification>



               <debugAudit>



                <testFlag>true</testFlag>



                <debugFlag>true</debugFlag>



                <performanceFlag>true</performanceFlag>



                <messageAuditFlag>true</messageAuditFlag>



               </debugAudit>



              </int:integrationHeader>



             </soap-env:Header>



             <soap-env:Body>



              <messages:getLocations

            xmlns:messages="http://www.royalmailgroup.com/API/LocalCollect/messages/V2.0">



               <locationType>string</locationType>



               <radius>string</radius>



               <postCode>string</postCode>



               <geoLocation>



                <latitude>string</latitude>



                <longitude>string</longitude>



               </geoLocation>



              </messages:getLocations>



             </soap-env:Body>



            </soap-env:Envelope>
        getLocationsFault:
          type: object
          properties:
            Envelope:
              xml:
                prefix: soap-env
                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
              type: object
              properties:
                Fault:
                  type: object
                  properties:
                    getLocalCollectFault:
                      $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/getLocalCollectLocationsFault'
        getLocalCollectLocationsFault:
          xml:
            prefix: int
            namespace: 'http://www.royalmailgroup.com/integration/core/V3'
          example: >-
            <int:getLocalCollectLocationsFault
            xmlns:int="http://www.royalmailgroup.com/integration/core/V3">



             <exceptionApplicationId>string</exceptionApplicationId>



             <exceptionTransactionId>string</exceptionTransactionId>



             <exceptionCode>string</exceptionCode>



             <exceptionText>string</exceptionText>



            </int:getLocalCollectLocationsFault>
          type: object
          properties:
            exceptionTransactionId:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/transactionId'
            exceptionApplicationId:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/applicationId'
            exceptionText:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            exceptionCode:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/errorCode'
          description: "RMG SOAP fault structure to be contained within 'detail' element"
        getLocationsResponse:
          xml:
            prefix: messages
            namespace: 'http://www.royalmailgroup.com/API/LocalCollect/messages/V2.0'
          example: >-
            <messages:getLocationsResponse
            xmlns:messages="http://www.royalmailgroup.com/API/LocalCollect/messages/V2.0"
            xmlns:ns1="http://www.royalmailgroup.com/API/LocalCollect/types/V2.0"
            xmlns:int="http://www.royalmailgroup.com/integration/core/V3">



             <locations>



              <location><!-- between zero and 20 repetitions of this element -->



               <organisationName>string</organisationName>



               <locationName>string</locationName>



               <addressLine1>string</addressLine1>



               <addressLine2>string</addressLine2>



               <addressLine3>string</addressLine3>



               <city>string</city>



               <county>string</county>



               <postcode>string</postcode>



               <openingHours><!-- mandatory --><!-- between 1 and 7 repetitions

            of this element -->



                <dayOfWeek>string</dayOfWeek>



                <openingTime>string</openingTime>



                <closingTime>string</closingTime>



                <lunchHours>



                 <lunchClosingTime>string</lunchClosingTime>



                 <lunchOpeningTime>string</lunchOpeningTime>



                </lunchHours>



               </openingHours>



               <geoLocation>



                <latitude>string</latitude>



                <longitude>string</longitude>



               </geoLocation>



               <distance>3</distance>



               <facilities>



                <customerParkingIndicator>true</customerParkingIndicator>



                <disabilityIndicator>true</disabilityIndicator>



               </facilities>



               <locationType>string</locationType>



              </location>



             </locations>



             <integrationFooter>



              <errors>



               <error><!-- between zero and unlimited repetitions of this
            element

            -->



                <errorCode>string</errorCode>



                <errorDescription>string</errorDescription>



                <errorCause>string</errorCause>



                <errorResolution>string</errorResolution>



                <errorContext>string</errorContext>



               </error>



              </errors>



              <warnings>



               <warning><!-- between zero and unlimited repetitions of this

            element -->



                <warningCode>string</warningCode>



                <warningDescription>string</warningDescription>



                <warningCause>string</warningCause>



                <warningResolution>string</warningResolution>



                <warningContext>string</warningContext>



               </warning>



              </warnings>



             </integrationFooter>



            </messages:getLocationsResponse>
          type: object
          properties:
            locations:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/locations'
            integrationFooter:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/integrationFooter'
          description: "The element represents the Local Collect response object. The location response consists of 2 parts.\n\t\t\tThe first part is the integration footer consisting or errors/warnings\n\t\t\tThe second part consists of an array of address elements representing the local collect offices."
        lunchTime:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            lunchClosingTime:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/time'
            lunchOpeningTime:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/time'
        integrationHeader:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            debugAudit:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/debugAuditStructure'
            version:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/decimal'
            identification:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/identificationStructure'
            dateTime:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/dateTime'
          description: >-
            Common integration header definition;

            dateTime: Date timestamp associated with when the data was generated,
            sent or received;

            version: Version of the service;

            identification: Identification details associated with the Service
            Requestor or Service Provider;

            debugAudit: Flags used to assist with troubleshooting, problem
            determination and to allow the performance and data exchanges between
            systems to be tracked and audited.
        geoSpatialPosition:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            latitude:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/geoSpatial'
            longitude:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/geoSpatial'
        dayOfWeek:
          xml:
            prefix: ''
            namespace: ''
          enum:
            - Monday
            - Tuesday
            - Wednesday
            - Thursday
            - Friday
            - Saturday
            - Sunday
          type: string
        warningDetail:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            warningCode:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/warningCode'
            warningDescription:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            warningResolution:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            warningContext:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            warningCause:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
          description: >-
            warningCode: Code associated with the warning;

            warningDescription: Description of the warning;

            warningCause: Cause of the warning (if known);

            warningResolution: Description of the resolution and action required
            to correct the warning;

            warningContext: Context of the warning, e.g. client or server
        description:
          xml:
            prefix: ''
            namespace: ''
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/string'
          description: A description is a sub-type of string and is statement in words that gives an account or descriptive representation of a thing. Descriptions are only editable via an admin function and are for display and information purposes only for end users.
          maxLength: 256
        warningStructure:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            warning:
              items:
                $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/warningDetail'
              type: array
        geoSpatial:
          xml:
            prefix: ''
            namespace: ''
          description: 'A decimal data type representing Latitude and Longitude data. The format of decimal 10,7 was chosen as a generic representation which facilities conversion between geospatial systems'
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/decimal'
        integrationFooter:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            errors:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/errorStructure'
            warnings:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/warningStructure'
          description: Common integration footer definition
        address:
          xml:
            prefix: ''
            namespace: ''
          required:
            - openingHours
          type: object
          properties:
            city:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/shortName'
            organisationName:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/longName'
            geoLocation:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/geoSpatialPosition'
            locationType:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/locationType'
            distance:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/integer'
            county:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/shortName'
            locationName:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/longName'
            facilities:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/facilities'
            addressLine2:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            addressLine3:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            addressLine1:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/description'
            openingHours:
              minItems: 1
              items:
                $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/openingTime'
              type: array
              maxItems: 7
            postcode:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/postcode'
          description: "The address element contains the address details for the local collect office. The main attributes of the address are\r\n\t\t\t<br>Organisation Name\t- This is either Post Office Limited or Royal Mail Ltd</br>\r\n\t\t\t<br>Location Name \t\t- This is the store name</br>\r\n\t\t\t<br>Address Line 1\t\t- This is first line of the address</br>\r\n\t\t\t<br>Post Code \t\t\t- This is the post code of the local collect location</br>\r\n\t\t\t<br>Opening Hours \t\t- Is an array of 7 elements, one for each day of the week. The element provides the day of the week, the opening time, closing time and mid day opening and closing hours.</br>\r\n\t\t\t<br>Geo Location\t\t- This is the latitude and longitude of the local collect office</br>\n\t\t\t<br>Distance\t\t\t- This is the distance of the local collect office from the search location</br>\n\t\t\t<br>Facilities\t\t\t- This element provides details of the facilities available. e.g. car parking or disability access</br>\n\t\t\t<br>Location Type\t\t- This element provides details on the type of location. This is an enumeration. e.g. whether POL or EO"
        warningCode:
          xml:
            prefix: ''
            namespace: ''
          pattern: '[W]{1}[0-9]{4}'
          description: Code associated with the warning condition in the form WNNNN
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/identifier'
        integer:
          xml:
            prefix: ''
            namespace: ''
          type: number
          description: 'An integer is a whole number (not a fraction) that can be positive, negative, or zero. Unlike floats, integers cannot have decimal places.'
        shortName:
          xml:
            prefix: ''
            namespace: ''
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/string'
          description: 'A name is a sub-type of string and is word or a combination of words by which a person, place, or thing, a body or class, or any object of thought is designated, called, or known. short name is intended for use with Reference data items'
          maxLength: 64
        getLocationsHeader:
          type: object
          properties:
            integrationHeader:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/integrationHeader'
            wsSecurityHeader:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/wsSecurityHeader'
        string:
          xml:
            prefix: ''
            namespace: ''
          type: string
          description: Simple set of alphanumeric characters.
          maxLength: 4000
        getLocationsOutput:
          type: object
          properties:
            Envelope:
              xml:
                prefix: soap-env
                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
              type: object
              properties:
                Body:
                  type: object
                  properties:
                    getLocationsResponse:
                      $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/getLocationsResponse'
          example: >-
            <soap-env:Envelope
            xmlns:soap-env="http://schemas.xmlsoap.org/soap/envelope/">



             <soap-env:Body>



              <messages:getLocationsResponse

            xmlns:messages="http://www.royalmailgroup.com/API/LocalCollect/messages/V2.0">



               <locations>



                <location><!-- between zero and 20 repetitions of this element

            -->



                 <organisationName>string</organisationName>



                 <locationName>string</locationName>



                 <addressLine1>string</addressLine1>



                 <addressLine2>string</addressLine2>



                 <addressLine3>string</addressLine3>



                 <city>string</city>



                 <county>string</county>



                 <postcode>string</postcode>



                 <openingHours><!-- mandatory --><!-- between 1 and
            7 repetitions

            of this element -->



                  <dayOfWeek>string</dayOfWeek>



                  <openingTime>string</openingTime>



                  <closingTime>string</closingTime>



                  <lunchHours>



                   <lunchClosingTime>string</lunchClosingTime>



                   <lunchOpeningTime>string</lunchOpeningTime>



                  </lunchHours>



                 </openingHours>



                 <geoLocation>



                  <latitude>string</latitude>



                  <longitude>string</longitude>



                 </geoLocation>



                 <distance>3</distance>



                 <facilities>



                  <customerParkingIndicator>true</customerParkingIndicator>



                  <disabilityIndicator>true</disabilityIndicator>



                 </facilities>



                 <locationType>string</locationType>



                </location>



               </locations>



               <integrationFooter>



                <errors>



                 <error><!-- between zero and unlimited repetitions of this

            element -->



                  <errorCode>string</errorCode>



                  <errorDescription>string</errorDescription>



                  <errorCause>string</errorCause>



                  <errorResolution>string</errorResolution>



                  <errorContext>string</errorContext>



                 </error>



                </errors>



                <warnings>



                 <warning><!-- between zero and unlimited repetitions of this

            element -->



                  <warningCode>string</warningCode>



                  <warningDescription>string</warningDescription>



                  <warningCause>string</warningCause>



                  <warningResolution>string</warningResolution>



                  <warningContext>string</warningContext>



                 </warning>



                </warnings>



               </integrationFooter>



              </messages:getLocationsResponse>



             </soap-env:Body>



            </soap-env:Envelope>
        getLocationsRequest:
          xml:
            prefix: messages
            namespace: 'http://www.royalmailgroup.com/API/LocalCollect/messages/V2.0'
          example: >-
            <messages:getLocations
            xmlns:messages="http://www.royalmailgroup.com/API/LocalCollect/messages/V2.0"
            xmlns:ns1="http://www.royalmailgroup.com/API/LocalCollect/types/V2.0">



             <locationType>string</locationType>



             <radius>string</radius>



             <postCode>string</postCode>



             <geoLocation>



              <latitude>string</latitude>



              <longitude>string</longitude>



             </geoLocation>



            </messages:getLocations>
          type: object
          properties:
            locationType:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/locationType'
            radius:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/radius'
            postCode:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/postcode'
            geoLocation:
              $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/geoSpatialPosition'
          description: "The element represents the Local Collect request object. The request consists of choice of either a valid UK post code or a lat and long representing the search location.\n\t\t\tThe request allows the caller to restrict the look up by a search radius and a location type.\n\t\t\tThe search radius is the radius from the centre of the look up post code\n\t\t\tThe location type allows the retailer to restrict the data returned from the api. e.g. only return POL or EO data.;\npostCode: Warning: CHOICE element;\ngeoLocation: Warning: CHOICE element"
        locationType:
          xml:
            prefix: ''
            namespace: ''
          enum:
            - Post Office
            - Enquiry Office
          type: string
        decimal:
          xml:
            prefix: ''
            namespace: ''
          type: string
          description: 'A decimal data type represents a real number with every decimal place indicating a multiple of a negative power of 10. It represents non-repeating decimal fractions like 0.3 and -1.17 without rounding, and gives the ability to do arithmetic on them.'
        errorStructure:
          xml:
            prefix: ''
            namespace: ''
          type: object
          properties:
            error:
              items:
                $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/errorDetail'
              type: array
        dateTime:
          xml:
            prefix: ''
            namespace: ''
          type: string
          description: 'dateTime represents a period in time which could be a particular month, day, and year at which some event happened or will happen but also includes a breakdown of time using hours, minutes, seconds and milliseconds. A dateTime stamp is a common use for this data type so that a precise record of an event can be captured.'
          format: date-time
        boolean:
          xml:
            prefix: ''
            namespace: ''
          type: boolean
          description: "Boolean, or boolean logic, is a subset of algebra used for creating true/false statements. Boolean expressions use the operators AND, OR, XOR, and NOT to compare values and return a true or false result. Boolean values can also be referred to as 'flags'."
        time:
          xml:
            prefix: ''
            namespace: ''
          type: string
          description: 'time is a unit of measure to record hours, minutes, seconds and milliseconds.'
        transactionId:
          xml:
            prefix: ''
            namespace: ''
          description: 'Id preserved throughout the lifespan of the transaction, unique when combined with the applicationId and intermediaryId (if applicable).'
          pattern: "[a-zA-Z0-9/\\-]*"
          maxLength: 50
          minLength: 1
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/identifier'
        identifier:
          xml:
            prefix: ''
            namespace: ''
          $ref: '#/x-ibm-configuration/targets/LocalCollectServicev2_0/definitions/string'
          description: An identifier is a sub-type of string which serves as a means of identification for a particular thing; An identifier can be associated with a name.
          maxLength: 128
      security:
        - clientID: []
      swagger: '2.0'
      x-ibm-configuration:
        enforced: true
        assembly:
          execute:
            - proxy:
                target-url: 'https://api.royalmail.com/localcollect/v2'
                title: proxy
        testable: true
        wsdl-definition:
          wsdl: 57bc66e40cf24c8d0c58b7c4
          soap-version: '1.1'
          port: LocalCollectPortv2_0
          service: LocalCollectServicev2_0
        cors:
          enabled: true
        phase: realized
        type: wsdl
        gateway: datapower-gateway
      consumes:
        - text/xml
  properties:
    Local Collect Endpoint:
      encoded: false
      description: Local Collect V2 endpoint
      value: 'https://live-api.royalmail.com/localcollect/v2'
    certificate name:
      encoded: false
      description: Default Certificate Name
      value: live-ca2
    Activity Log Level:
      encoded: false
      description: 'What to log per api call. Choices are none, activity, header, payload'
      value: payload
    Error Log Level:
      encoded: false
      description: 'What to log per api error. Choices are none, activity, header, payload'
      value: payload
  cors:
    enabled: true
  phase: realized
  catalogs: {}
  testable: true
  gateway: datapower-gateway
securityDefinitions:
  CLIENT_ID:
    type: apiKey
    name: X-IBM-Client-Id
    in: header
definitions:
  geoLocation:
    type: object
    properties:
      latitude:
        type: number
        format: float
      longitude:
        type: number
        format: float
  warningResponse:
    type: object
    properties:
      resolution:
        type: string
      code:
        type: number
      cause:
        type: string
      description:
        type: string
      context:
        type: string
  facilities:
    type: object
    properties:
      customerParkingIndicator:
        type: boolean
      disabilityIndicator:
        type: boolean
  location:
    additionalProperties: true
    type: object
    properties:
      city:
        type: string
      organisationName:
        type: string
      geoLocation:
        $ref: '#/definitions/geoLocation'
      locationType:
        pattern: 'Enquiry Office|Post Office'
        type: string
      distance:
        type: integer
      county:
        type: string
      locationName:
        type: string
      facilities:
        $ref: '#/definitions/facilities'
      addressLine2:
        type: string
      addressLine3:
        type: string
      addressLine1:
        type: string
      openingHours:
        items:
          $ref: '#/definitions/openingHours'
        type: array
      postcode:
        type: string
  openingHours:
    type: object
    properties:
      dayOfWeek:
        type: string
      openingTime:
        type: string
      lunchHours:
        $ref: '#/definitions/lunchHours'
      closingTime:
        type: string
  lunchHours:
    type: object
    properties:
      lunchOpening:
        type: string
      lunchClosing:
        type: string
  locationResponse:
    type: object
    properties:
      locations:
        items:
          $ref: '#/definitions/location'
        type: array
      warnings:
        items:
          $ref: '#/definitions/warningResponse'
        type: array
  errorResponse:
    type: object
    properties:
      status:
        type: number
      code:
        type: number
      description:
        type: string
      cause:
        type: string
      context:
        type: string
      resolution:
        type: string
security:
  - CLIENT_ID: []
swagger: '2.0'
