info:
  x-ibm-name: local-collect-api-live-rest
  version: 1-rev2
  description: "Local Collect is a delivery enhancement to Royal Mail Tracked & Special Delivery Guaranteed products that enables customers to benefit from ‘Click and Collect’ options by having their parcels delivered to participating Post Offices. The Local Collect API allows customers to retrieve an up-to-date list of Post Offices and confirm selection in a given location, where the item will be held awaiting collection.\n \nThere are no costs to customers for using the Local Collect API services, however development costs must be covered by the customer. Royal Mail will not accept any responsibility for these development, implementation and testing costs."
  title: Local Collect API LIVE (REST)
paths:
  '/{bookingReference}':
    put:
      responses:
        '201':
          examples:
            application/json:
              error:
                resolution: ''
                code: ''
                cause: ''
                description: ''
                context: ''
              request:
                bookingReference: ''
              reservationReference: ''
              location:
                county: ''
                openingDays:
                  - dayOfWeek: ''
                    openingTime: ''
                    lunchOpeningTime: ''
                    lunchClosingTime: ''
                    closingTime: ''
                organisationName: ''
                longitude: ''
                locationName: ''
                addressLine4: ''
                searchDistance: ''
                addressLine2: ''
                addressLine3: ''
                addressLine1: ''
                latitude: ''
                availability: ''
                postcode: ''
          description: ''
          schema:
            type: object
            properties:
              error:
                type: object
                properties:
                  resolution:
                    type: string
                  code:
                    type: string
                  cause:
                    type: string
                  description:
                    type: string
                  context:
                    type: string
              request:
                type: object
                properties:
                  bookingReference:
                    type: string
              reservationReference:
                type: string
              location:
                type: object
                properties:
                  county:
                    type: string
                  openingDays:
                    items:
                      type: object
                      properties:
                        dayOfWeek:
                          type: string
                        openingTime:
                          type: string
                        lunchOpeningTime:
                          type: string
                        lunchClosingTime:
                          type: string
                        closingTime:
                          type: string
                    type: array
                  organisationName:
                    type: string
                  longitude:
                    type: string
                  locationName:
                    type: string
                  addressLine4:
                    type: string
                  searchDistance:
                    type: string
                  addressLine2:
                    type: string
                  addressLine3:
                    type: string
                  addressLine1:
                    type: string
                  latitude:
                    type: string
                  availability:
                    type: string
                  postcode:
                    type: string
        '500':
          headers: {}
          schema:
            type: object
            properties:
              moreInformation:
                type: string
              httpMessage:
                type: string
              httpCode:
                type: string
          description: General error
          examples:
            application/json:
              moreInformation: Please contact the RMG Customer Solutions Team
              httpMessage: Internal Server Error
              httpCode: '500'
      parameters:
        - required: true
          type: string
          description: This is the reference for the estimated delivery date and location where capacity is to be reserved.
          in: path
          name: bookingReference
        - in: body
          description: ''
          name: body
          schema: {}
      tags: []
      summary: Confirms delivery for a selected Post Office.
      security:
        - Client ID: []
          Client Secret: []
      description: Confirms selection in a given Post Office for a delivery to ensure there is sufficient physical space for parcels to be held awaiting collection.
  /geosearch:
    get:
      responses:
        '200':
          examples:
            application/json:
              request:
                latitiude: '51.49000'
                estDeliveryDate: '2015-09-15'
                radius: '10'
                longitude: '-0.16317'
              locations:
                - bookingReference: ''
                  county: ''
                  openingDays:
                    - dayOfWeek: ''
                      openingTime: ''
                      lunchOpeningTime: ''
                      lunchClosingTime: ''
                      closingTime: ''
                  organisationName: ''
                  longitude: ''
                  locationName: ''
                  addressLine4: ''
                  searchDistance: ''
                  addressLine2: ''
                  addressLine3: ''
                  addressLine1: ''
                  latitude: ''
                  availability: ''
                  postcode: ''
              error:
                resolution: ''
                code: ''
                cause: ''
                description: ''
          description: ''
          schema:
            type: object
            properties:
              request:
                type: object
                properties:
                  latitiude:
                    type: string
                  estDeliveryDate:
                    type: string
                    description: 'should be in YYYY-MM-DD format, at least 1 day in the future, but not more than 30 days ahead'
                  radius:
                    type: string
                    description: should be in miles up to a maximum of 99.0
                  longitude:
                    type: string
              locations:
                items:
                  type: object
                  properties:
                    bookingReference:
                      type: string
                    county:
                      type: string
                    openingDays:
                      items:
                        type: object
                        properties:
                          dayOfWeek:
                            type: string
                          openingTime:
                            type: string
                          lunchOpeningTime:
                            type: string
                          lunchClosingTime:
                            type: string
                          closingTime:
                            type: string
                      type: array
                    organisationName:
                      type: string
                    longitude:
                      type: string
                    locationName:
                      type: string
                    addressLine4:
                      type: string
                    searchDistance:
                      type: string
                    addressLine2:
                      type: string
                    addressLine3:
                      type: string
                    addressLine1:
                      type: string
                    latitude:
                      type: string
                    availability:
                      type: string
                    postcode:
                      type: string
                type: array
              error:
                type: object
                properties:
                  resolution:
                    type: string
                  code:
                    type: string
                  cause:
                    type: string
                  description:
                    type: string
        '500':
          headers: {}
          schema:
            type: object
            properties:
              moreInformation:
                type: string
              httpMessage:
                type: string
              httpCode:
                type: string
          description: General error
          examples:
            application/json:
              moreInformation: Please contact the RMG Customer Solutions Team
              httpMessage: Internal Server Error
              httpCode: '500'
      parameters:
        - description: 'This is the date (in YYYY-MM-DD format) when the parcel is anticipated to arrive at the Post Office (taking into account Royal Mail product used to deliver the item e.g.Tracked 24). If customers do not know when the parcel will be despatched (e.g. due to consumers ordering out of stock items) customers should specify a delivery date that assumes the order will be despatched on the same day (as the order). Notes: 1. estimatedDeliveryDate must be at least one day in the future; 2. estDeliveryDate cannot be more than 30 days in the future'
          default: estDeliveryDate
          required: true
          in: query
          type: string
          name: estDeliveryDate
        - description: '(optional) - The number of results returned is determined by the use of the radius parameter (although if this is omitted a pre-determined [20] number of locations will be returned).'
          default: radius
          required: false
          in: query
          type: string
          name: radius
        - description: 'Provide longitude position to search for Post Offices near by, only UK postcodes are supported.'
          default: longitude
          required: true
          in: query
          type: string
          name: longitude
        - description: 'Provide latitude position to search for Post Offices near by, only UK postcodes are supported.'
          default: latitude
          required: true
          in: query
          type: string
          name: latitude
      tags: []
      summary: Returns the list of Post Office Locations based on geospatial search.
      security:
        - Client ID: []
          Client Secret: []
      description: Retrieves an up-to-date list of Post Offices that offer Local Collect and have sufficient capacity to receive parcels (for a given location and delivery date).
  /:
    get:
      responses:
        '200':
          examples:
            application/json:
              request:
                estDeliveryDate: '2015-09-15'
                radius: '10'
                postcode: SW34TR
              locations:
                - bookingReference: ''
                  county: ''
                  openingDays:
                    - dayOfWeek: ''
                      openingTime: ''
                      lunchOpeningTime: ''
                      lunchClosingTime: ''
                      closingTime: ''
                  organisationName: ''
                  longitude: ''
                  locationName: ''
                  addressLine4: ''
                  searchDistance: ''
                  addressLine2: ''
                  addressLine3: ''
                  addressLine1: ''
                  latitude: ''
                  availability: ''
                  postcode: ''
              error:
                resolution: ''
                code: ''
                cause: ''
                description: ''
          description: ''
          schema:
            type: object
            properties:
              request:
                type: object
                properties:
                  estDeliveryDate:
                    type: string
                    description: 'should be in YYYY-MM-DD format, at least 1 day in the future, but not more than 30 days ahead'
                  radius:
                    type: string
                    description: should be in miles up to a maximum of 99.0
                  postcode:
                    type: string
                    description: UK only; should be in upper case and no space
              locations:
                items:
                  type: object
                  properties:
                    bookingReference:
                      type: string
                    county:
                      type: string
                    openingDays:
                      items:
                        type: object
                        properties:
                          dayOfWeek:
                            type: string
                          openingTime:
                            type: string
                          lunchOpeningTime:
                            type: string
                          lunchClosingTime:
                            type: string
                          closingTime:
                            type: string
                      type: array
                    organisationName:
                      type: string
                    longitude:
                      type: string
                    locationName:
                      type: string
                    addressLine4:
                      type: string
                    searchDistance:
                      type: string
                    addressLine2:
                      type: string
                    addressLine3:
                      type: string
                    addressLine1:
                      type: string
                    latitude:
                      type: string
                    availability:
                      type: string
                    postcode:
                      type: string
                type: array
              error:
                type: object
                properties:
                  resolution:
                    type: string
                  code:
                    type: string
                  cause:
                    type: string
                  description:
                    type: string
        '500':
          headers: {}
          schema: {}
          description: General error
          examples:
            application/json:
              moreInformation: Please contact the RMG Customer Solutions Team
              httpMessage: Internal Server Error
              httpCode: '500'
      parameters:
        - description: 'This is the date (in YYYY-MM-DD format) when the parcel is anticipated to arrive at the Post Office (taking into account Royal Mail product used to deliver the item e.g.Tracked 24). If customers do not know when the parcel will be despatched (e.g. due to consumers ordering out of stock items) customers should specify a delivery date that assumes the order will be despatched on the same day (as the order). Notes: 1. estimatedDeliveryDate must be at least one day in the future; 2. estDeliveryDate cannot be more than 30 days in the future'
          default: '{estDeliveryDate}'
          required: true
          in: query
          type: string
          name: estDeliveryDate
        - description: '(optional) - The number of results returned is determined by the use of the radius parameter (although if this is omitted a pre-determined [20] number of locations will be returned).'
          default: '{radius}'
          required: false
          in: query
          type: string
          name: radius
        - description: This is the Postcode of the location to search for Post Offices near. Only UK postcodes are supported.
          default: '{postcode}'
          required: true
          in: query
          type: string
          name: postcode
      tags: []
      summary: Returns a list of Post Office locations based on Postcode search.
      security:
        - Client ID: []
          Client Secret: []
      description: Retrieves an up-to-date list of Post Offices that offer Local Collect and have sufficient capacity to receive parcels (for a given location and delivery date).
schemes:
  - https
tags: []
basePath: /localCollectOffices
x-ibm-configuration:
  enforced: true
  catalogs: {}
  externalDocs: []
  gateway: datapower-gateway
  cors:
    enabled: true
  phase: realized
  assembly:
    execute:
      - operation-switch:
          case:
            - operations:
                - path: /
                  verb: get
              execute:
                - map:
                    inputs:
                      in1:
                        variable: request.parameters
                        schema:
                          type: object
                          properties:
                            estDeliveryDate:
                              type: string
                            radius:
                              type: string
                            postcode:
                              type: string
                    options:
                      inlineNamespaces: false
                    actions:
                      - set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.searchPostcode
                        from: '#/in1.postcode'
                      - default: 99
                        set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.radius
                        from: '#/in1.radius'
                        value: apim.v4.toNumber($(1))
                      - set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.estimatedDeliveryDate
                        from: '#/in1.estDeliveryDate'
                      - default: $(client.app.id)
                        set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.integrationHeader.identification.applicationId
                      - default: $(request.headers.x-global-transaction-id)
                        set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.integrationHeader.identification.transactionId
                      - default: 'text/xml; charset="UTF-8"'
                        set: out2.Content-Type
                      - default: '"urn:getLCDeliveryLocations"'
                        set: out2.SOAPAction
                    outputs:
                      out1:
                        variable: message.body
                        content: application/xml
                        schema:
                          type: object
                          properties:
                            Envelope:
                              xml:
                                prefix: soap11-env
                                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                              type: object
                              properties:
                                Body:
                                  type: object
                                  properties:
                                    GetLCDeliveryLocationsRequest:
                                      xml:
                                        prefix: p1
                                        namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                      type: object
                                      properties:
                                        integrationHeader:
                                          xml:
                                            prefix: p0
                                            namespace: 'http://www.royalmailgroup.com/integration/core/V1'
                                          type: object
                                          properties:
                                            identification:
                                              type: object
                                              properties:
                                                transactionId:
                                                  default: $(request.headers.x-global-transaction-id)
                                                  type: string
                                                applicationId:
                                                  default: $(client.app.id)
                                                  type: string
                                        estimatedDeliveryDate:
                                          type: string
                                        radius:
                                          default: 99
                                          type: number
                                          format: float
                                        searchPostcode:
                                          type: string
                      out2:
                        variable: message.headers
                        schema:
                          type: object
                          properties:
                            SOAPAction:
                              default: '"urn:getLCDeliveryLocations"'
                              type: string
                            Content-Type:
                              default: 'text/xml; charset="UTF-8"'
                              type: string
                - invoke:
                    timeout: 60
                    title: Web Service Invoke Operation
                    tls-profile: 55fa95140cf2d7f58fccdece
                    target-url: $(Local Collect Endpoint)
                    verb: POST
                    stop-on-error:
                      - ConnectionError
                      - OperationError
                    output: response2
                - if:
                    execute:
                      - gatewayscript:
                          source: 'apim.error("StopFlow","500","Internal Server Error","Please contact the RMG Customer Solutions Team")'
                    condition: apim.util.isSOAPError($(response2))
                    title: if
                - activity-log:
                    content: $(Activity Log Level)
                    title: Activity Log
                    error-content: $(Error Log Level)
                - map:
                    inputs:
                      in1:
                        variable: response2.body
                        content: application/xml
                        schema:
                          type: object
                          properties:
                            Envelope:
                              xml:
                                prefix: soap11-env
                                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                              type: object
                              properties:
                                Body:
                                  type: object
                                  properties:
                                    Fault:
                                      type: object
                                      properties:
                                        faultcode:
                                          enum:
                                            - VersionMismatch
                                            - MustUnderstand
                                            - Client
                                            - Server
                                          type: string
                                        faultstring:
                                          type: string
                                        faultactor:
                                          type: string
                                        detail:
                                          type: object
                                          properties:
                                            details:
                                              xml:
                                                prefix: p2
                                                namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                              type: object
                                              properties:
                                                code:
                                                  type: string
                                                description:
                                                  type: string
                                    GetLCDeliveryLocationsResponse:
                                      xml:
                                        prefix: p1
                                        namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                      type: object
                                      properties:
                                        integrationHeader:
                                          xml:
                                            prefix: p0
                                            namespace: 'http://www.royalmailgroup.com/integration/core/V1'
                                          type: object
                                          properties:
                                            date:
                                              type: string
                                            version:
                                              type: number
                                              format: float
                                            identification:
                                              type: object
                                              properties:
                                                intermediaryId:
                                                  type: string
                                                transactionId:
                                                  type: string
                                                applicationId:
                                                  type: string
                                        locations:
                                          type: object
                                          properties:
                                            location:
                                              items:
                                                type: object
                                                properties:
                                                  organisationName:
                                                    type: string
                                                  locationPosition:
                                                    type: object
                                                    properties:
                                                      latitude:
                                                        xml:
                                                          namespace: ''
                                                        type: number
                                                        format: float
                                                      altitude:
                                                        xml:
                                                          namespace: ''
                                                        type: number
                                                        format: float
                                                      geoDeticSystem:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          systemNameCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                      longitude:
                                                        xml:
                                                          namespace: ''
                                                        type: number
                                                        format: float
                                                      geoSpatialPositionType:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          geospatialPositionCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                  locationName:
                                                    type: string
                                                  searchDistance:
                                                    type: string
                                                  openingDay:
                                                    items:
                                                      type: object
                                                      properties:
                                                        openingTime:
                                                          type: string
                                                        closingTime:
                                                          type: string
                                                        dayOfWeekType:
                                                          type: object
                                                          properties:
                                                            dayOfWeekCode:
                                                              xml:
                                                                namespace: ''
                                                              type: object
                                                              properties:
                                                                code:
                                                                  type: string
                                                                name:
                                                                  type: string
                                                                description:
                                                                  type: string
                                                        lunchTime:
                                                          type: object
                                                          properties:
                                                            lunchClosingTime:
                                                              type: string
                                                            lunchOpeningTime:
                                                              type: string
                                                    type: array
                                                  address:
                                                    type: object
                                                    properties:
                                                      status:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          status:
                                                            type: object
                                                            properties:
                                                              statusCode:
                                                                type: object
                                                                properties:
                                                                  code:
                                                                    type: string
                                                                  name:
                                                                    type: string
                                                                  description:
                                                                    type: string
                                                          validTo:
                                                            type: string
                                                          validFrom:
                                                            type: string
                                                      audit:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          lastUpdateDate:
                                                            type: string
                                                          lastUpdateUserIdentifier:
                                                            type: string
                                                      addressUsageType:
                                                        xml:
                                                          namespace: ''
                                                        items:
                                                          type: object
                                                          properties:
                                                            addressUsageCode:
                                                              type: object
                                                              properties:
                                                                code:
                                                                  type: string
                                                                name:
                                                                  type: string
                                                                description:
                                                                  type: string
                                                        type: array
                                                      country:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          countryCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                      postTown:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      county:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          countyCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                      addressLine4:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      addressLine2:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      addressLine3:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      domesticIndicator:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      addressLine1:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      stateOrProvince:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          stateOrProvinceCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                      postcode:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      buildingNumber:
                                                        xml:
                                                          namespace: ''
                                                        type: number
                                                        format: float
                                                      buildingName:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                  lCAvailability:
                                                    type: string
                                                  lCBookingReference:
                                                    type: string
                                              type: array
                                        errorResponse:
                                          type: object
                                          properties:
                                            errorCode:
                                              type: object
                                              properties:
                                                code:
                                                  type: string
                                                description:
                                                  type: string
                                            errorResolution:
                                              type: string
                                            errorCause:
                                              type: string
                      in2:
                        variable: request.parameters
                        schema:
                          type: object
                          properties:
                            estDeliveryDate:
                              type: string
                            radius:
                              type: string
                            postcode:
                              type: string
                    options:
                      inlineNamespaces: false
                    actions:
                      - create: out1.locations
                        from: '#/in1.Envelope.Body.GetLCDeliveryLocationsResponse.locations.location'
                        foreach: '#/in1.Envelope.Body.GetLCDeliveryLocationsResponse.locations.location'
                        actions:
                          - set: bookingReference
                            from: lCBookingReference
                          - set: organisationName
                            from: organisationName
                          - set: locationName
                            from: locationName
                          - set: addressLine1
                            from: address.addressLine1
                          - set: addressLine2
                            from: address.addressLine2
                          - set: addressLine3
                            from: address.addressLine3
                          - set: addressLine4
                            from: address.addressLine4
                          - set: county
                            from: address.county.countyCode.name
                          - set: postcode
                            from: address.postcode
                          - set: longitude
                            from: locationPosition.longitude
                            value: apim.v4.toString($(1))
                          - set: latitude
                            from: locationPosition.latitude
                            value: apim.v4.toString($(1))
                          - set: availability
                            from: lCAvailability
                          - set: searchDistance
                            from: searchDistance
                          - create: openingDays
                            from: openingDay
                            foreach: openingDay
                            actions:
                              - set: dayOfWeek
                                from: dayOfWeekType.dayOfWeekCode.name
                              - set: openingTime
                                from: openingTime
                              - set: closingTime
                                from: closingTime
                              - set: lunchOpeningTime
                                from: lunchTime.lunchOpeningTime
                              - set: lunchClosingTime
                                from: lunchTime.lunchClosingTime
                      - set: out1.request.postcode
                        from: '#/in2.postcode'
                      - set: out1.request.estDeliveryDate
                        from: '#/in2.estDeliveryDate'
                      - set: out1.request.radius
                        from: '#/in2.radius'
                      - set: out1.error.code
                        from: '#/in1.Envelope.Body.GetLCDeliveryLocationsResponse.errorResponse.errorCode.code'
                      - set: out1.error.description
                        from: '#/in1.Envelope.Body.GetLCDeliveryLocationsResponse.errorResponse.errorCode.description'
                      - set: out1.error.cause
                        from: '#/in1.Envelope.Body.GetLCDeliveryLocationsResponse.errorResponse.errorCause'
                      - set: out1.error.resolution
                        from: '#/in1.Envelope.Body.GetLCDeliveryLocationsResponse.errorResponse.errorResolution'
                      - default: 200
                        set: out2
                    outputs:
                      out1:
                        variable: message.body
                        content: application/json
                        schema:
                          type: object
                          properties:
                            request:
                              type: object
                              properties:
                                estDeliveryDate:
                                  type: string
                                radius:
                                  type: string
                                postcode:
                                  type: string
                            locations:
                              items:
                                type: object
                                properties:
                                  bookingReference:
                                    type: string
                                  county:
                                    type: string
                                  openingDays:
                                    items:
                                      type: object
                                      properties:
                                        dayOfWeek:
                                          type: string
                                        openingTime:
                                          type: string
                                        lunchOpeningTime:
                                          type: string
                                        lunchClosingTime:
                                          type: string
                                        closingTime:
                                          type: string
                                    type: array
                                  organisationName:
                                    type: string
                                  longitude:
                                    type: string
                                  locationName:
                                    type: string
                                  addressLine4:
                                    type: string
                                  searchDistance:
                                    type: string
                                  addressLine2:
                                    type: string
                                  addressLine3:
                                    type: string
                                  addressLine1:
                                    type: string
                                  latitude:
                                    type: string
                                  availability:
                                    type: string
                                  postcode:
                                    type: string
                              type: array
                            error:
                              type: object
                              properties:
                                resolution:
                                  type: string
                                code:
                                  type: string
                                cause:
                                  type: string
                                description:
                                  type: string
                      out2:
                        variable: message.status.code
                        schema:
                          default: 200
                          type: integer
                          format: int32
                      out3:
                        variable: message.headers
                        schema:
                          type: object
            - operations:
                - path: /geosearch
                  verb: get
              execute:
                - map:
                    inputs:
                      in1:
                        variable: request.parameters
                        schema:
                          type: object
                          properties:
                            latitude:
                              type: string
                            estDeliveryDate:
                              type: string
                            radius:
                              type: string
                            longitude:
                              type: string
                    options:
                      inlineNamespaces: false
                    actions:
                      - default: 99
                        set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.radius
                        from: '#/in1.radius'
                        value: apim.v4.toNumber($(1))
                      - set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.estimatedDeliveryDate
                        from: '#/in1.estDeliveryDate'
                      - set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.searchPosition.longitude
                        from: '#/in1.longitude'
                        value: apim.v4.toNumber($(1))
                      - set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.searchPosition.latitude
                        from: '#/in1.latitude'
                        value: apim.v4.toNumber($(1))
                      - default: $(client.app.id)
                        set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.integrationHeader.identification.applicationId
                      - default: $(request.headers.x-global-transaction-id)
                        set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.integrationHeader.identification.transactionId
                      - default: WGS84
                        set: out1.Envelope.Body.GetLCDeliveryLocationsRequest.searchPosition.geoDeticSystem.systemNameCode.code
                      - default: 'text/xml; charset="UTF-8"'
                        set: out2.Content-Type
                      - default: '"urn:getLCDeliveryLocations"'
                        set: out2.SOAPAction
                    outputs:
                      out1:
                        variable: message.body
                        content: application/xml
                        schema:
                          type: object
                          properties:
                            Envelope:
                              xml:
                                prefix: soap11-env
                                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                              type: object
                              properties:
                                Body:
                                  type: object
                                  properties:
                                    GetLCDeliveryLocationsRequest:
                                      xml:
                                        prefix: p1
                                        namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                      type: object
                                      properties:
                                        integrationHeader:
                                          xml:
                                            prefix: p0
                                            namespace: 'http://www.royalmailgroup.com/integration/core/V1'
                                          type: object
                                          properties:
                                            identification:
                                              type: object
                                              properties:
                                                transactionId:
                                                  default: $(request.headers.x-global-transaction-id)
                                                  type: string
                                                applicationId:
                                                  default: $(client.app.id)
                                                  type: string
                                        searchPosition:
                                          type: object
                                          properties:
                                            latitude:
                                              xml:
                                                namespace: ''
                                              type: number
                                              format: float
                                            geoDeticSystem:
                                              xml:
                                                namespace: ''
                                              type: object
                                              properties:
                                                systemNameCode:
                                                  type: object
                                                  properties:
                                                    code:
                                                      default: WGS84
                                                      type: string
                                            longitude:
                                              xml:
                                                namespace: ''
                                              type: number
                                              format: float
                                        radius:
                                          default: 99
                                          type: number
                                          format: float
                                        estimatedDeliveryDate:
                                          type: string
                      out2:
                        variable: message.headers
                        schema:
                          type: object
                          properties:
                            SOAPAction:
                              default: '"urn:getLCDeliveryLocations"'
                              type: string
                            Content-Type:
                              default: 'text/xml; charset="UTF-8"'
                              type: string
                - invoke:
                    timeout: 60
                    title: Web Service Invoke Operation 2
                    tls-profile: 55fa95140cf2d7f58fccdece
                    target-url: $(Local Collect Endpoint)
                    verb: POST
                    stop-on-error:
                      - ConnectionError
                      - OperationError
                    output: response2
                - if:
                    execute:
                      - gatewayscript:
                          source: 'apim.error("StopFlow","500","Internal Server Error","Please contact the RMG Customer Solutions Team")'
                    condition: apim.util.isSOAPError($(response2))
                    title: if
                - activity-log:
                    content: $(Activity Log Level)
                    title: Activity Log 2
                    error-content: $(Error Log Level)
                - map:
                    inputs:
                      in1:
                        variable: request.parameters
                        schema:
                          type: object
                          properties:
                            latitude:
                              type: string
                            estDeliveryDate:
                              type: string
                            radius:
                              type: string
                            longitude:
                              type: string
                      in2:
                        variable: response2.body
                        content: application/xml
                        schema:
                          type: object
                          properties:
                            Envelope:
                              xml:
                                prefix: soap11-env
                                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                              type: object
                              properties:
                                Body:
                                  type: object
                                  properties:
                                    Fault:
                                      type: object
                                      properties:
                                        faultcode:
                                          enum:
                                            - VersionMismatch
                                            - MustUnderstand
                                            - Client
                                            - Server
                                          type: string
                                        faultstring:
                                          type: string
                                        faultactor:
                                          type: string
                                        detail:
                                          type: object
                                          properties:
                                            details:
                                              xml:
                                                prefix: p2
                                                namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                              type: object
                                              properties:
                                                code:
                                                  type: string
                                                description:
                                                  type: string
                                    GetLCDeliveryLocationsResponse:
                                      xml:
                                        prefix: p1
                                        namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                      type: object
                                      properties:
                                        integrationHeader:
                                          xml:
                                            prefix: p0
                                            namespace: 'http://www.royalmailgroup.com/integration/core/V1'
                                          type: object
                                          properties:
                                            date:
                                              type: string
                                            version:
                                              type: number
                                              format: float
                                            identification:
                                              type: object
                                              properties:
                                                intermediaryId:
                                                  type: string
                                                transactionId:
                                                  type: string
                                                applicationId:
                                                  type: string
                                        locations:
                                          type: object
                                          properties:
                                            location:
                                              items:
                                                type: object
                                                properties:
                                                  organisationName:
                                                    type: string
                                                  locationPosition:
                                                    type: object
                                                    properties:
                                                      latitude:
                                                        xml:
                                                          namespace: ''
                                                        type: number
                                                        format: float
                                                      altitude:
                                                        xml:
                                                          namespace: ''
                                                        type: number
                                                        format: float
                                                      geoDeticSystem:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          systemNameCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                      longitude:
                                                        xml:
                                                          namespace: ''
                                                        type: number
                                                        format: float
                                                      geoSpatialPositionType:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          geospatialPositionCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                  locationName:
                                                    type: string
                                                  searchDistance:
                                                    type: string
                                                  openingDay:
                                                    items:
                                                      type: object
                                                      properties:
                                                        openingTime:
                                                          type: string
                                                        closingTime:
                                                          type: string
                                                        dayOfWeekType:
                                                          type: object
                                                          properties:
                                                            dayOfWeekCode:
                                                              xml:
                                                                namespace: ''
                                                              type: object
                                                              properties:
                                                                code:
                                                                  type: string
                                                                name:
                                                                  type: string
                                                                description:
                                                                  type: string
                                                        lunchTime:
                                                          type: object
                                                          properties:
                                                            lunchClosingTime:
                                                              type: string
                                                            lunchOpeningTime:
                                                              type: string
                                                    type: array
                                                  address:
                                                    type: object
                                                    properties:
                                                      status:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          status:
                                                            type: object
                                                            properties:
                                                              statusCode:
                                                                type: object
                                                                properties:
                                                                  code:
                                                                    type: string
                                                                  name:
                                                                    type: string
                                                                  description:
                                                                    type: string
                                                          validTo:
                                                            type: string
                                                          validFrom:
                                                            type: string
                                                      audit:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          lastUpdateDate:
                                                            type: string
                                                          lastUpdateUserIdentifier:
                                                            type: string
                                                      addressUsageType:
                                                        xml:
                                                          namespace: ''
                                                        items:
                                                          type: object
                                                          properties:
                                                            addressUsageCode:
                                                              type: object
                                                              properties:
                                                                code:
                                                                  type: string
                                                                name:
                                                                  type: string
                                                                description:
                                                                  type: string
                                                        type: array
                                                      country:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          countryCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                      postTown:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      county:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          countyCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                      addressLine4:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      addressLine2:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      addressLine3:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      domesticIndicator:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      addressLine1:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      stateOrProvince:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          stateOrProvinceCode:
                                                            type: object
                                                            properties:
                                                              code:
                                                                type: string
                                                              name:
                                                                type: string
                                                              description:
                                                                type: string
                                                      postcode:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                      buildingNumber:
                                                        xml:
                                                          namespace: ''
                                                        type: number
                                                        format: float
                                                      buildingName:
                                                        xml:
                                                          namespace: ''
                                                        type: string
                                                  lCAvailability:
                                                    type: string
                                                  lCBookingReference:
                                                    type: string
                                              type: array
                                        errorResponse:
                                          type: object
                                          properties:
                                            errorCode:
                                              type: object
                                              properties:
                                                code:
                                                  type: string
                                                description:
                                                  type: string
                                            errorResolution:
                                              type: string
                                            errorCause:
                                              type: string
                    options:
                      inlineNamespaces: false
                    actions:
                      - create: out1.locations
                        from: '#/in2.Envelope.Body.GetLCDeliveryLocationsResponse.locations.location'
                        foreach: '#/in2.Envelope.Body.GetLCDeliveryLocationsResponse.locations.location'
                        actions:
                          - set: bookingReference
                            from: lCBookingReference
                          - set: organisationName
                            from: organisationName
                          - set: locationName
                            from: locationName
                          - set: addressLine1
                            from: address.addressLine1
                          - set: addressLine2
                            from: address.addressLine2
                          - set: addressLine3
                            from: address.addressLine3
                          - set: addressLine4
                            from: address.addressLine4
                          - set: county
                            from: address.county.countyCode.name
                          - set: postcode
                            from: address.postcode
                          - set: longitude
                            from: locationPosition.longitude
                            value: apim.v4.toString($(1))
                          - set: latitude
                            from: locationPosition.latitude
                            value: apim.v4.toString($(1))
                          - set: availability
                            from: lCAvailability
                          - set: searchDistance
                            from: searchDistance
                          - create: openingDays
                            from: openingDay
                            foreach: openingDay
                            actions:
                              - set: dayOfWeek
                                from: dayOfWeekType.dayOfWeekCode.name
                              - set: openingTime
                                from: openingTime
                              - set: closingTime
                                from: closingTime
                              - set: lunchOpeningTime
                                from: lunchTime.lunchOpeningTime
                              - set: lunchClosingTime
                                from: lunchTime.lunchClosingTime
                      - set: out1.request.longitude
                        from: '#/in1.longitude'
                      - set: out1.request.latitiude
                        from: '#/in1.latitude'
                      - set: out1.request.estDeliveryDate
                        from: '#/in1.estDeliveryDate'
                      - set: out1.request.radius
                        from: '#/in1.radius'
                      - set: out1.error.code
                        from: '#/in2.Envelope.Body.GetLCDeliveryLocationsResponse.errorResponse.errorCode.code'
                      - set: out1.error.description
                        from: '#/in2.Envelope.Body.GetLCDeliveryLocationsResponse.errorResponse.errorCode.description'
                      - set: out1.error.cause
                        from: '#/in2.Envelope.Body.GetLCDeliveryLocationsResponse.errorResponse.errorCause'
                      - set: out1.error.resolution
                        from: '#/in2.Envelope.Body.GetLCDeliveryLocationsResponse.errorResponse.errorResolution'
                      - default: 200
                        set: out2
                    outputs:
                      out1:
                        variable: message.body
                        content: application/json
                        schema:
                          type: object
                          properties:
                            request:
                              type: object
                              properties:
                                latitiude:
                                  type: string
                                estDeliveryDate:
                                  type: string
                                radius:
                                  type: string
                                longitude:
                                  type: string
                            locations:
                              items:
                                type: object
                                properties:
                                  bookingReference:
                                    type: string
                                  county:
                                    type: string
                                  openingDays:
                                    items:
                                      type: object
                                      properties:
                                        dayOfWeek:
                                          type: string
                                        openingTime:
                                          type: string
                                        lunchOpeningTime:
                                          type: string
                                        lunchClosingTime:
                                          type: string
                                        closingTime:
                                          type: string
                                    type: array
                                  organisationName:
                                    type: string
                                  longitude:
                                    type: string
                                  locationName:
                                    type: string
                                  addressLine4:
                                    type: string
                                  searchDistance:
                                    type: string
                                  addressLine2:
                                    type: string
                                  addressLine3:
                                    type: string
                                  addressLine1:
                                    type: string
                                  latitude:
                                    type: string
                                  availability:
                                    type: string
                                  postcode:
                                    type: string
                              type: array
                            error:
                              type: object
                              properties:
                                resolution:
                                  type: string
                                code:
                                  type: string
                                cause:
                                  type: string
                                description:
                                  type: string
                      out2:
                        variable: message.status.code
                        schema:
                          default: 200
                          type: integer
                          format: int32
                      out3:
                        variable: message.headers
                        schema:
                          type: object
            - operations:
                - path: '/{bookingReference}'
                  verb: put
              execute:
                - map:
                    inputs:
                      in1:
                        variable: request.parameters
                        schema:
                          type: object
                          properties:
                            bookingReference:
                              type: string
                    options:
                      inlineNamespaces: false
                    actions:
                      - set: out1.Envelope.Body.SetLCDeliveryLocationRequest.lCBookingReference
                        from: '#/in1.bookingReference'
                        value: "apim.v4.replace(apim.v4.replace(apim.v4.replace(apim.v4.replace(apim.v4.replace(apim.v4.replace(apim.v4.replace($(1), \"0x2F\", \"/\"), \"0x2B\", \"+\"), \"0x25\", \"%\"), \"0x23\", \"#\"), \"0x3F\", \"?\"), \"0x5C\", \"\\\"), \"0x3B\", \";\")"
                      - default: $(client.app.id)
                        set: out1.Envelope.Body.SetLCDeliveryLocationRequest.integrationHeader.identification.applicationId
                      - default: $(request.headers.x-global-transaction-id)
                        set: out1.Envelope.Body.SetLCDeliveryLocationRequest.integrationHeader.identification.transactionId
                      - default: 'text/xml; charset="UTF-8"'
                        set: out2.Content-Type
                      - default: '"urn:setLCDeliveryLocation"'
                        set: out2.SOAPAction
                    outputs:
                      out1:
                        variable: message.body
                        content: application/xml
                        schema:
                          type: object
                          properties:
                            Envelope:
                              xml:
                                prefix: soap11-env
                                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                              type: object
                              properties:
                                Body:
                                  type: object
                                  properties:
                                    SetLCDeliveryLocationRequest:
                                      xml:
                                        prefix: p1
                                        namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                      type: object
                                      properties:
                                        integrationHeader:
                                          xml:
                                            prefix: p0
                                            namespace: 'http://www.royalmailgroup.com/integration/core/V1'
                                          type: object
                                          properties:
                                            identification:
                                              type: object
                                              properties:
                                                transactionId:
                                                  default: $(request.headers.x-global-transaction-id)
                                                  type: string
                                                applicationId:
                                                  default: $(client.app.id)
                                                  type: string
                                        lCBookingReference:
                                          type: string
                      out2:
                        variable: message.headers
                        schema:
                          type: object
                          properties:
                            SOAPAction:
                              default: '"urn:setLCDeliveryLocation"'
                              type: string
                            Content-Type:
                              default: 'text/xml; charset="UTF-8"'
                              type: string
                - invoke:
                    timeout: 60
                    title: Web Service Invoke Operation 26
                    tls-profile: 55fa95140cf2d7f58fccdece
                    target-url: $(Local Collect Endpoint)
                    verb: POST
                    stop-on-error:
                      - ConnectionError
                      - OperationError
                    output: response2
                - if:
                    execute:
                      - gatewayscript:
                          source: 'apim.error("StopFlow","500","Internal Server Error","Please contact the RMG Customer Solutions Team")'
                    condition: apim.util.isSOAPError($(response2))
                    title: if
                - activity-log:
                    content: $(Activity Log Level)
                    title: Activity Log 8
                    error-content: $(Error Log Level)
                - map:
                    inputs:
                      in1:
                        variable: request.parameters
                        schema:
                          type: object
                          properties:
                            bookingReference:
                              type: string
                      in2:
                        variable: response2.body
                        content: application/xml
                        schema:
                          type: object
                          properties:
                            Envelope:
                              xml:
                                prefix: soap11-env
                                namespace: 'http://schemas.xmlsoap.org/soap/envelope/'
                              type: object
                              properties:
                                Body:
                                  type: object
                                  properties:
                                    Fault:
                                      type: object
                                      properties:
                                        faultcode:
                                          enum:
                                            - VersionMismatch
                                            - MustUnderstand
                                            - Client
                                            - Server
                                          type: string
                                        faultstring:
                                          type: string
                                        faultactor:
                                          type: string
                                        detail:
                                          type: object
                                          properties:
                                            details:
                                              xml:
                                                prefix: p2
                                                namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                              type: object
                                              properties:
                                                code:
                                                  type: string
                                                description:
                                                  type: string
                                    SetLCDeliveryLocationResponse:
                                      xml:
                                        prefix: p1
                                        namespace: 'http://www.royalmailgroup.com/API/LocalCollect/V2.0'
                                      type: object
                                      properties:
                                        integrationHeader:
                                          xml:
                                            prefix: p0
                                            namespace: 'http://www.royalmailgroup.com/integration/core/V1'
                                          type: object
                                          properties:
                                            date:
                                              type: string
                                            version:
                                              type: number
                                              format: float
                                            identification:
                                              type: object
                                              properties:
                                                intermediaryId:
                                                  type: string
                                                transactionId:
                                                  type: string
                                                applicationId:
                                                  type: string
                                        reservationReference:
                                          type: string
                                        errorResponse:
                                          type: object
                                          properties:
                                            errorCode:
                                              type: object
                                              properties:
                                                code:
                                                  type: string
                                                description:
                                                  type: string
                                            errorResolution:
                                              type: string
                                            errorCause:
                                              type: string
                                        location:
                                          type: object
                                          properties:
                                            organisationName:
                                              type: string
                                            locationPosition:
                                              type: object
                                              properties:
                                                latitude:
                                                  xml:
                                                    namespace: ''
                                                  type: number
                                                  format: float
                                                altitude:
                                                  xml:
                                                    namespace: ''
                                                  type: number
                                                  format: float
                                                geoDeticSystem:
                                                  xml:
                                                    namespace: ''
                                                  type: object
                                                  properties:
                                                    systemNameCode:
                                                      type: object
                                                      properties:
                                                        code:
                                                          type: string
                                                        name:
                                                          type: string
                                                        description:
                                                          type: string
                                                longitude:
                                                  xml:
                                                    namespace: ''
                                                  type: number
                                                  format: float
                                                geoSpatialPositionType:
                                                  xml:
                                                    namespace: ''
                                                  type: object
                                                  properties:
                                                    geospatialPositionCode:
                                                      type: object
                                                      properties:
                                                        code:
                                                          type: string
                                                        name:
                                                          type: string
                                                        description:
                                                          type: string
                                            locationName:
                                              type: string
                                            searchDistance:
                                              type: string
                                            openingDay:
                                              items:
                                                type: object
                                                properties:
                                                  openingTime:
                                                    type: string
                                                  closingTime:
                                                    type: string
                                                  dayOfWeekType:
                                                    type: object
                                                    properties:
                                                      dayOfWeekCode:
                                                        xml:
                                                          namespace: ''
                                                        type: object
                                                        properties:
                                                          code:
                                                            type: string
                                                          name:
                                                            type: string
                                                          description:
                                                            type: string
                                                  lunchTime:
                                                    type: object
                                                    properties:
                                                      lunchClosingTime:
                                                        type: string
                                                      lunchOpeningTime:
                                                        type: string
                                              type: array
                                            address:
                                              type: object
                                              properties:
                                                status:
                                                  xml:
                                                    namespace: ''
                                                  type: object
                                                  properties:
                                                    status:
                                                      type: object
                                                      properties:
                                                        statusCode:
                                                          type: object
                                                          properties:
                                                            code:
                                                              type: string
                                                            name:
                                                              type: string
                                                            description:
                                                              type: string
                                                    validTo:
                                                      type: string
                                                    validFrom:
                                                      type: string
                                                audit:
                                                  xml:
                                                    namespace: ''
                                                  type: object
                                                  properties:
                                                    lastUpdateDate:
                                                      type: string
                                                    lastUpdateUserIdentifier:
                                                      type: string
                                                addressUsageType:
                                                  xml:
                                                    namespace: ''
                                                  items:
                                                    type: object
                                                    properties:
                                                      addressUsageCode:
                                                        type: object
                                                        properties:
                                                          code:
                                                            type: string
                                                          name:
                                                            type: string
                                                          description:
                                                            type: string
                                                  type: array
                                                country:
                                                  xml:
                                                    namespace: ''
                                                  type: object
                                                  properties:
                                                    countryCode:
                                                      type: object
                                                      properties:
                                                        code:
                                                          type: string
                                                        name:
                                                          type: string
                                                        description:
                                                          type: string
                                                postTown:
                                                  xml:
                                                    namespace: ''
                                                  type: string
                                                county:
                                                  xml:
                                                    namespace: ''
                                                  type: object
                                                  properties:
                                                    countyCode:
                                                      type: object
                                                      properties:
                                                        code:
                                                          type: string
                                                        name:
                                                          type: string
                                                        description:
                                                          type: string
                                                addressLine4:
                                                  xml:
                                                    namespace: ''
                                                  type: string
                                                addressLine2:
                                                  xml:
                                                    namespace: ''
                                                  type: string
                                                addressLine3:
                                                  xml:
                                                    namespace: ''
                                                  type: string
                                                domesticIndicator:
                                                  xml:
                                                    namespace: ''
                                                  type: string
                                                addressLine1:
                                                  xml:
                                                    namespace: ''
                                                  type: string
                                                stateOrProvince:
                                                  xml:
                                                    namespace: ''
                                                  type: object
                                                  properties:
                                                    stateOrProvinceCode:
                                                      type: object
                                                      properties:
                                                        code:
                                                          type: string
                                                        name:
                                                          type: string
                                                        description:
                                                          type: string
                                                postcode:
                                                  xml:
                                                    namespace: ''
                                                  type: string
                                                buildingNumber:
                                                  xml:
                                                    namespace: ''
                                                  type: number
                                                  format: float
                                                buildingName:
                                                  xml:
                                                    namespace: ''
                                                  type: string
                                            lCAvailability:
                                              type: string
                                            lCBookingReference:
                                              type: string
                    options:
                      inlineNamespaces: false
                    actions:
                      - set: out1.reservationReference
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.reservationReference'
                      - set: out1.request.bookingReference
                        from: '#/in1.bookingReference'
                      - set: out1.location.organisationName
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.organisationName'
                      - set: out1.location.locationName
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.locationName'
                      - set: out1.location.addressLine1
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.address.addressLine1'
                      - set: out1.location.addressLine2
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.address.addressLine2'
                      - set: out1.location.addressLine3
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.address.addressLine3'
                      - set: out1.location.addressLine4
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.address.addressLine4'
                      - set: out1.location.county
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.address.county.countyCode.name'
                      - set: out1.location.postcode
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.address.postcode'
                      - set: out1.location.longitude
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.locationPosition.longitude'
                        value: apim.v4.toString($(1))
                      - set: out1.location.latitude
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.locationPosition.latitude'
                        value: apim.v4.toString($(1))
                      - set: out1.location.availability
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.lCAvailability'
                      - set: out1.location.searchDistance
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.searchDistance'
                      - create: out1.location.openingDays
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.openingDay'
                        foreach: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.location.openingDay'
                        actions:
                          - set: dayOfWeek
                            from: dayOfWeekType.dayOfWeekCode.name
                          - set: openingTime
                            from: openingTime
                          - set: closingTime
                            from: closingTime
                          - set: lunchOpeningTime
                            from: lunchTime.lunchOpeningTime
                          - set: lunchClosingTime
                            from: lunchTime.lunchClosingTime
                      - set: out1.error.code
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.errorResponse.errorCode.code'
                      - set: out1.error.description
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.errorResponse.errorCode.description'
                      - set: out1.error.cause
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.errorResponse.errorCause'
                      - set: out1.error.resolution
                        from: '#/in2.Envelope.Body.SetLCDeliveryLocationResponse.errorResponse.errorResolution'
                      - default: 201
                        set: out2
                    outputs:
                      out1:
                        variable: message.body
                        content: application/json
                        schema:
                          type: object
                          properties:
                            error:
                              type: object
                              properties:
                                resolution:
                                  type: string
                                code:
                                  type: string
                                cause:
                                  type: string
                                description:
                                  type: string
                                context:
                                  type: string
                            request:
                              type: object
                              properties:
                                bookingReference:
                                  type: string
                            reservationReference:
                              type: string
                            location:
                              type: object
                              properties:
                                county:
                                  type: string
                                openingDays:
                                  items:
                                    type: object
                                    properties:
                                      dayOfWeek:
                                        type: string
                                      openingTime:
                                        type: string
                                      lunchOpeningTime:
                                        type: string
                                      lunchClosingTime:
                                        type: string
                                      closingTime:
                                        type: string
                                  type: array
                                organisationName:
                                  type: string
                                longitude:
                                  type: string
                                locationName:
                                  type: string
                                addressLine4:
                                  type: string
                                searchDistance:
                                  type: string
                                addressLine2:
                                  type: string
                                addressLine3:
                                  type: string
                                addressLine1:
                                  type: string
                                latitude:
                                  type: string
                                availability:
                                  type: string
                                postcode:
                                  type: string
                      out2:
                        variable: message.status.code
                        schema:
                          default: 201
                          type: integer
                          format: int32
                      out3:
                        variable: message.headers
                        schema:
                          type: object
          title: operation-switch
  testable: true
  properties:
    Local Collect Endpoint:
      encoded: false
      description: ''
      value: 'https://localcollect.royalmail.com:28642/axis2/services/LocalCollect'
    ApplicationId:
      encoded: false
      description: Local Collect Application ID value
      value: '943016001'
    Activity Log Level:
      encoded: false
      description: 'What to log per api call. Choices are none, activity, header, payload'
      value: payload
    Error Log Level:
      encoded: false
      description: 'What to log per api error. Choices are none, activity, header, payload'
      value: payload
securityDefinitions:
  Client ID:
    type: apiKey
    description: ''
    name: X-IBM-Client-Id
    in: header
  Client Secret:
    description: ''
    type: apiKey
    name: X-IBM-Client-Secret
    in: header
definitions: {}
security: []
swagger: '2.0'
